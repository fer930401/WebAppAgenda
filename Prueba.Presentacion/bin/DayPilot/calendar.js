
if(typeof DayPilot==='undefined'){var DayPilot={};};if(typeof DayPilotCalendar==='undefined'){var DayPilotCalendar=DayPilot.CalendarVisible={};};(function(){var $a=function(){};if(typeof DayPilot.Calendar!=='undefined'){return;};var DayPilotCalendar={};DayPilotCalendar.selectedCells=null;DayPilotCalendar.topSelectedCell=null;DayPilotCalendar.bottomSelectedCell=null;DayPilotCalendar.selecting=false;DayPilotCalendar.column=null;DayPilotCalendar.firstSelected=null;DayPilotCalendar.firstMousePos=null;DayPilotCalendar.originalMouse=null;DayPilotCalendar.originalHeight=null;DayPilotCalendar.originalTop=null;DayPilotCalendar.resizing=null;DayPilotCalendar.globalHandlers=false;DayPilotCalendar.moving=null;DayPilotCalendar.originalLeft=null;DayPilotCalendar.editing=false;DayPilotCalendar.originalText=null;DayPilotCalendar.debug=null;DayPilotCalendar.register=function($b){if(!DayPilotCalendar.registered){DayPilotCalendar.registered=[];};var r=DayPilotCalendar.registered;for(var i=0;i<r.length;i++){if(r[i]===$b){return;}};r.push($b);};DayPilotCalendar.unregister=function($b){var a=DayPilotCalendar.registered;if(!a){return;};var $c=function($d,$e){if(!$d||!$d.length){return -1;};for(var i=0;i<$d.length;i++){if($d[i]===$e){return i;}};return -1;};var i=$c(a,$b);if(i===-1){return;};a.splice(i,1);};DayPilotCalendar.getCellsAbove=function($f){var $d=[];var c=DayPilotCalendar.getColumn($f);var tr=$f.parentNode;var $g=null;while(tr&&$g!==DayPilotCalendar.firstSelected){$g=tr.getElementsByTagName("td")[c];$d.push($g);tr=tr.previousSibling;while(tr&&tr.tagName!=="TR"){tr=tr.previousSibling;}};return $d;};DayPilotCalendar.getCellsBelow=function($f){var $d=[];var c=DayPilotCalendar.getColumn($f);var tr=$f.parentNode;var $g=null;while(tr&&$g!==DayPilotCalendar.firstSelected){$g=tr.getElementsByTagName("td")[c];$d.push($g);tr=tr.nextSibling;while(tr&&tr.tagName!=="TR"){tr=tr.nextSibling;}};return $d;};DayPilotCalendar.getColumn=function($f){var i=0;while($f.previousSibling){$f=$f.previousSibling;if($f.tagName==="TD"){i++;}};return i;};DayPilotCalendar.getShadowColumn=function($e){if(!$e){return null;};var $h=$e.parentNode;while($h&&$h.tagName!=="TD"){$h=$h.parentNode;};return $h;};DayPilotCalendar.gMouseMove=function(ev){if(typeof(DayPilotCalendar)==='undefined'){return;};var $i=DayPilot.mc(ev);if(DayPilotCalendar.drag){document.body.style.cursor='move';if(!DayPilotCalendar.gShadow){DayPilotCalendar.gShadow=DayPilotCalendar.createGShadow(DayPilotCalendar.drag.shadowType);};var $j=DayPilotCalendar.gShadow;$j.style.left=$i.x+'px';$j.style.top=$i.y+'px';DayPilotCalendar.moving=null;DayPilotCalendar.deleteShadow(DayPilotCalendar.movingShadow);DayPilotCalendar.movingShadow=null;}};DayPilotCalendar.gUnload=function(ev){if(!DayPilotCalendar.registered){return;};var r=DayPilotCalendar.registered;for(var i=0;i<r.length;i++){var c=r[i];c.dispose();DayPilotCalendar.unregister(c);}};DayPilotCalendar.gMouseUp=function(e){if(DayPilotCalendar.resizing){var $k=DayPilotCalendar.resizing.dirty;var $l=DayPilotCalendar.resizing.event;var $m=DayPilotCalendar.resizingShadow.clientHeight+4;var top=DayPilotCalendar.resizingShadow.offsetTop;var $n=DayPilotCalendar.resizing.dpBorder;DayPilotCalendar.deleteShadow(DayPilotCalendar.resizingShadow);DayPilotCalendar.resizing.style.cursor='default';document.body.style.cursor='default';DayPilotCalendar.resizing=null;if($l.root.overlap){return;};if($k){$l.root.eventResizeDispatch($l,$m,top,$n);}}else if(DayPilotCalendar.moving){var $k=DayPilotCalendar.moving.dirty;var $o=DayPilotCalendar.moving.oldColumn;var top=DayPilotCalendar.movingShadow.offsetTop;DayPilotCalendar.deleteShadow(DayPilotCalendar.movingShadow);var $l=DayPilotCalendar.moving;var $p=DayPilotCalendar.movingShadow.column;DayPilotCalendar.moving=null;DayPilotCalendar.movingShadow=null;document.body.style.cursor='default';if(DayPilotCalendar.drag){if(!$l.root.todo){$l.root.todo={};};$l.root.todo.del=DayPilotCalendar.drag.element;};if($l.root.overlap){return;};if($k){var ev=e||window.event;$l.root.eventMoveDispatch($l,$p,top,ev);}};if(DayPilotCalendar.drag){DayPilotCalendar.drag=null;document.body.style.cursor=null;};if(DayPilotCalendar.gShadow){document.body.removeChild(DayPilotCalendar.gShadow);DayPilotCalendar.gShadow=null;};DayPilotCalendar.moveOffsetY=null;};DayPilotCalendar.dragStart=function(element,$q,id,$r,$s){DayPilot.us(element);var $t=DayPilotCalendar.drag={};$t.element=element;$t.duration=$q;$t.text=$r;$t.id=id;$t.shadowType=$s?$s:'Fill';return false;};DayPilotCalendar.deleteShadow=function($j){if(!$j){return;};if(!$j.parentNode){return;};$j.parentNode.removeChild($j);};DayPilotCalendar.createShadow=function($e,$u,$s){var $h=$e.parentNode;while($h&&$h.tagName!=="TD"){$h=$h.parentNode;};var $j=document.createElement('div');$j.setAttribute('unselectable','on');$j.style.position='absolute';$j.style.width=($e.offsetWidth-4)+'px';$j.style.height=($e.offsetHeight-4)+'px';$j.style.left=($e.offsetLeft)+'px';$j.style.top=($e.offsetTop)+'px';$j.style.border='2px dotted #666666';$j.style.zIndex=101;if($s==='Fill'){$j.style.backgroundColor="#aaaaaa";$j.style.opacity=0.5;$j.style.filter="alpha(opacity=50)";$j.style.border='2px solid #aaaaaa';if($u){$j.style.overflow='hidden';$j.style.fontSize=$e.style.fontSize;$j.style.fontFamily=$e.style.fontFamily;$j.style.color=$e.style.color;$j.innerHTML=$e.data.InnerHTML;}};if($e.event&&$e.event.root&&$e.event.root.roundedCorners){$j.style.MozBorderRadius="5px";$j.style.webkitBorderRadius="5px";$j.style.borderRadius="5px";};$h.firstChild.appendChild($j);return $j;};DayPilotCalendar.createGShadow=function($s){var $j=document.createElement('div');$j.setAttribute('unselectable','on');$j.style.position='absolute';$j.style.width='100px';$j.style.height='20px';$j.style.border='2px dotted #666666';$j.style.zIndex=101;if($s==='Fill'){$j.style.backgroundColor="#aaaaaa";$j.style.opacity=0.5;$j.style.filter="alpha(opacity=50)";$j.style.border='2px solid #aaaaaa';};document.body.appendChild($j);return $j;};DayPilotCalendar.moveShadow=function($v){var $j=DayPilotCalendar.movingShadow;var parent=$j.parentNode;parent.style.display='none';$j.parentNode.removeChild($j);$v.firstChild.appendChild($j);$j.style.left='0px';parent.style.display='';$j.style.width=(DayPilotCalendar.movingShadow.parentNode.offsetWidth+1)+'px';};DayPilotCalendar.Calendar=function(id){var $w=false;if(this instanceof DayPilotCalendar.Calendar&&!this.$2C){$w=true;this.$2C=true;};if(!$w){throw "DayPilot.Calendar() is a constructor and must be called as 'var c = new DayPilot.Calendar(id);'";};var $b=this;this.uniqueID=null;this.id=id;this.clientName=id;this.selectedEvents=[];this.clientState={};this.cache={};this.cache.pixels={};this.elements={};this.elements.events=[];this.nav={};this.afterRender=function(){};this.fasterDispose=true;this.allDayEventBorderColor="#000000";this.allDayEventFontFamily='Tahoma';this.allDayEventFontSize='8pt';this.allDayEventFontColor="#000000";this.allDayEventHeight=16;this.allowEventOverlap=true;this.autoRefreshCommand='refresh';this.autoRefreshEnabled=false;this.autoRefreshInterval=60;this.autoRefreshMaxCount=20;this.borderColor="#000000";this.businessBeginsHour=9;this.businessEndsHour=18;this.cellBackColor="#FFFFD5";this.cellBackColorNonBusiness="#FFF4BC";this.cellBorderColor="#999999";this.cellHeight=20;this.cellDuration=30;this.columnMarginRight=5;this.cornerBackColor="#ECE9D8";this.dayBeginsHour=0;this.dayEndsHour=24;this.autoHide=true;this.days=1;this.deleteImageUrl=null;this.durationBarColor='blue';this.durationBarVisible=true;this.durationBarWidth=5;this.durationBarImageUrl=null;this.eventArrangement="SideBySide";this.eventBackColor='#ffffff';this.eventBorderColor="#000000";this.eventFontFamily='Tahoma';this.eventFontSize='8pt';this.eventFontColor="#000000";this.eventSelectColor='blue';this.headerFontSize='10pt';this.headerFontFamily='Tahoma';this.headerFontColor="#000000";this.headerHeight=21;this.headerLevels=1;this.height=300;this.heightSpec='BusinessHours';this.hourHalfBorderColor="#F3E4B1";this.hourBorderColor="#EAD098";this.hourFontColor="#000000";this.hourFontFamily="Tahoma";this.hourFontSize="16pt";this.hourNameBackColor="#ECE9D8";this.hourNameBorderColor="#ACA899";this.hourWidth=45;this.initScrollPos=0;this.loadingLabelText="Loading...";this.loadingLabelVisible=true;this.loadingLabelBackColor="orange";this.loadingLabelFontColor="#ffffff";this.loadingLabelFontFamily="Tahoma";this.loadingLabelFontSize="10pt";this.moveBy="Left";this.numberFormat="0.00";this.roundedCorners=false;this.rtl=false;this.selectedColor="#316AC5";this.shadow='Fill';this.showToolTip=true;this.showAllDayEvents=false;this.showAllDayEventStartEnd=true;this.showHeader=true;this.showHours=true;this.startDate=new DayPilot.Date().getDatePart();this.timeFormat='Clock12Hours';this.useEventBoxes='Always';this.viewType='Days';this.timeRangeSelectedHandling='Disabled';this.eventClickHandling='Disabled';this.eventDoubleClickHandling='Disabled';this.eventRightClickHandling='Disabled';this.eventDeleteHandling='Disabled';this.eventEditHandling='Disabled';this.eventHoverHandling='Bubble';this.eventResizeHandling='Disabled';this.eventMoveHandling='Disabled';this.headerClickHandling='Disabled';this.transparent=false;this.bg=false;this.autoRefreshCount=0;this.clearSelection=function(){for(var j=0;j<DayPilotCalendar.selectedCells.length;j++){var $f=DayPilotCalendar.selectedCells[j];if($f){$f.style.backgroundColor=$f.originalColor;$f.selected=false;}}};this.ie=(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("MSIE")!==-1);this.ff=(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")!==-1);this.opera105=(function(){if(/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var v=new Number(RegExp.$1);return v>=10.5;};return false;})();this.webkit522=(function(){if(/AppleWebKit[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var v=new Number(RegExp.$1);return v>=522;};return false;})();this.ie9=(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("MSIE 9")!==-1);this.cleanSelection=this.clearSelection;this.postBack2=function($x,$y,$z){var $A={};$A.action=$x;$A.parameters=$z;$A.data=$y;$A.header=this.getCallBackHeader();var $B="JSON"+DayPilot.JSON.stringify($A);__doPostBack($b.uniqueID,$B);};this.callBack2=function($x,$y,$z){if(this.callbackTimeout){window.clearTimeout(this.callbackTimeout);};this.callbackTimeout=window.setTimeout(function(){$b.loadingStart();},100);var $A={};$A.action=$x;$A.parameters=$z;$A.data=$y;$A.header=this.getCallBackHeader();var $B="JSON"+DayPilot.JSON.stringify($A);if(this.backendUrl){DayPilot.request(this.backendUrl,this.callBackResponse,$B,this.ajaxError);}else{WebForm_DoCallback(this.uniqueID,$B,this.updateView,this.clientName,this.callbackError,true);}};this.dispose=function(){var c=$b;c.deleteEvents();if(c.nav.messageClose){c.nav.messageClose.onclick=null;};if(c.nav.hourTable)c.nav.hourTable.oncontextmenu=null;if(c.nav.header)c.nav.header.oncontextmenu=null;if(c.nav.header)c.nav.corner.oncontextmenu=null;c.nav.zoom.onmousemove=null;c.nav.scroll.onscroll=null;c.nav.scroll.root=null;DayPilot.pu(c.nav.loading);c.disposeMain();c.disposeHeader();c.nav.select=null;c.nav.cornerRight=null;c.nav.scrollable=null;c.nav.allday=null;c.nav.zoom=null;c.nav.loading=null;c.nav.header=null;c.nav.hourTable=null;c.nav.scrolltop=null;c.nav.scroll=null;c.nav.vsph=null;c.nav.main=null;c.nav.message=null;c.nav.messageClose=null;c.nav.top=null;DayPilot.ue(window,'resize',c.resize);DayPilotCalendar.unregister(c);};this.registerDispose=function(){var $C=document.getElementById(id);$C.dispose=this.dispose;};this.callBackResponse=function($D){$b.updateView($D.responseText);};this.getCallBackHeader=function(){var h={};h.control="dpc";h.id=this.id;h.clientState=$b.clientState;h.columns=this.getTreeState();h.days=$b.days;h.startDate=$b.startDate;h.cellDuration=$b.cellDuration;h.heightSpec=$b.heightSpec;h.businessBeginsHour=$b.businessBeginsHour;h.businessEndsHour=$b.businessEndsHour;h.viewType=$b.viewType;h.dayBeginsHour=$b.dayBeginsHour;h.dayEndsHour=$b.dayEndsHour;h.headerLevels=$b.headerLevels;h.backColor=$b.cellBackColor;h.nonBusinessBackColor=$b.cellBackColorNonBusiness;h.eventHeaderVisible=$b.eventHeaderVisible;h.timeFormat=$b.timeFormat;h.locale=$b.locale;h.showAllDayEvents=$b.showAllDayEvents;h.tagFields=$b.tagFields;h.hourNameBackColor=$b.hourNameBackColor;h.hourFontFamily=$b.hourFontFamily;h.hourFontSize=$b.hourFontSize;h.hourFontColor=$b.hourFontColor;h.selected=$b.nav.select.value;h.hashes=$b.hashes;return h;};this.getTreeState=function(){var $E=[];$E.ignoreToJSON=true;if(!this.columns){return $E;};for(var i=0;i<this.columns.length;i++){var $v=this.columns[i];var $F=this.getNodeState($v);$E.push($F);};return $E;};this.getNodeState=function($v){var $F={};$F.Value=$v.Value;$F.Name=$v.Name;$F.ToolTip=$v.ToolTip;$F.Date=$v.Start;$F.Children=this.getNodeChildren($v.Children);return $F;};this.getNodeChildren=function($d){var $G=[];$G.ignoreToJSON=true;if(!$d){return $G;};for(var i=0;i<$d.length;i++){$G.push(this.getNodeState($d[i]));};return $G;};this.listener=function($e){if(!this.listeners){this.listeners=[];};this.listeners.push($e);};this.callListeners=function($x,$y){if(!this.listeners){return;};for(var i=0;i<this.listeners.length;i++){this.listeners[i]();}};this.updateView=function($H,$I){var $H=eval("("+$H+")");$b.debug("updateView:"+$H.UpdateType);if($H.BubbleGuid){var $J=$H.BubbleGuid;var $K=this.bubbles[$J];delete this.bubbles[$J];$b.loadingStop();$K.updateView($H.Result.BubbleHTML,$K);return;};if($H.UpdateType==="None"){$b.loadingStop();if($H.Message){$b.message($H.Message,5000);};return;};if($H.VsUpdate){var $L=document.createElement("input");$L.type='hidden';$L.name=$b.id+"_vsupdate";$L.id=$L.name;$L.value=$H.VsUpdate;$b.nav.vsph.innerHTML='';$b.nav.vsph.appendChild($L);};$b.divDeselectAll();$b.deleteEvents();if($H.UpdateType==="Full"){$b.colors=$H.Colors;$b.columns=$H.Columns;$b.days=$H.Days;$b.startDate=new DayPilot.Date($H.StartDate);$b.cellDuration=$H.CellDuration;$b.heightSpec=$H.HeightSpec?$H.HeightSpec:$b.heightSpec;$b.businessBeginsHour=$H.BusinessBeginsHour?$H.BusinessBeginsHour:$b.businessBeginsHour;$b.businessEndsHour=$H.BusinessEndsHour?$H.BusinessEndsHour:$b.businessEndsHour;$b.viewType=$H.ViewType;$b.headerLevels=$H.HeaderLevels;$b.backColor=$H.BackColor?$H.BackColor:$b.backColor;$b.nonBusinessBackColor=$H.NonBusinessBackColor?$H.NonBusinessBackColor:$b.nonBusinessBackColor;$b.eventHeaderVisible=$H.EventHeaderVisible?$H.EventHeaderVisible:$b.eventHeaderVisible;$b.timeFormat=$H.TimeFormat?$H.TimeFormat:$b.timeFormat;$b.locale=$H.Locale?$H.Locale:$b.locale;$b.dayBeginsHour=typeof $H.DayBeginsHour!='undefined'?$H.DayBeginsHour:$b.dayBeginsHour;$b.dayEndsHour=typeof $H.DayEndsHour!='undefined'?$H.DayEndsHour:$b.dayEndsHour;$b.cornerBackColor=$H.CornerBackColor;$b.cornerHTML=$H.CornerHTML;$b.hours=$H.Hours;$b.prepareColumns();};if($H.Hashes){for($M in $H.Hashes){$b.hashes[$M]=$H.Hashes[$M];}};$b.loadEvents($H.Events);$b.updateHeaderHeight();if($H.TagFields){$b.tagFields=$H.TagFields;};if($H.UpdateType==="Full"||$b.autoHide){$b.deleteScrollLabels();$b.updateMessagePosition();$b.drawHeader();$b.drawMain();$b.drawHourTable();$b.updateHeight();};$b.drawEvents();$b.drawEventsAllDay();if($b.timeRangeSelectedHandling!=="HoldForever"){$b.clearSelection();};$b.updateScrollLabels();if($b.todo){if($b.todo.del){var $N=$b.todo.del;$N.parentNode.removeChild($N);$b.todo.del=null;}};$b.afterRender($H.CallBackData,true);$b.loadingStop();$b.startAutoRefresh();if($H.Message){$b.message($H.Message,20000);}};this.$=function($O){return document.getElementById(id+"_"+$O);};this.isOverlapping=function($v){var $j=DayPilotCalendar.movingShadow||DayPilotCalendar.resizingShadow;var $e=DayPilotCalendar.moving||DayPilotCalendar.resizing;if(!$j){return false;};if(!$v){$v=$e.data.DayIndex;};var $P=parseInt($j.style.top,10);var $Q=parseInt($j.style.height,10);var $R=$P+$Q;for(var i=0;i<this.events.length;i++){var $y=this.events[i];if($v!==$y.DayIndex){continue;};var pk=$e.event.value();if($y.Value===pk){continue;};var $S=$y.Top+$y.Height;if($P>=$S||$R<=$y.Top){continue;}else{return true;}};return false;};this.createShadow=function($q,$s){var $T=$b.nav.main;var $U=$T.clientWidth/$T.rows[0].cells.length;var i=Math.floor(($b.coords.x-45)/$U);var $v=$T.rows[0].cells[i];var $m=$q*$b.cellHeight/(60*$b.cellDuration);var $V=1;var top=Math.floor((($b.coords.y-$V)+$b.cellHeight/2) / $b.cellHeight)*$b.cellHeight+$V;var $j=document.createElement('div');$j.setAttribute('unselectable','on');$j.style.position='absolute';$j.style.width=($v.offsetWidth-4)+'px';$j.style.height=($m-4)+'px';$j.style.left='0px';$j.style.top=top+'px';$j.style.border='2px dotted #666666';$j.style.zIndex=101;$j.exclude=true;if($s==='Fill'){$j.style.backgroundColor="#aaaaaa";$j.style.opacity=0.5;$j.style.filter="alpha(opacity=50)";$j.style.border='2px solid #aaaaaa';};if(this.roundedCorners){$j.style.MozBorderRadius="5px";$j.style.webkitBorderRadius="5px";$j.style.borderRadius="5px";};$v.firstChild.appendChild($j);return $j;};this.duration=function($W){var $X=0;if(this.heightSpec==='BusinessHoursNoScroll'){if(this.businessBeginsHour>this.businessEndsHour){$Y=24-this.businessBeginsHour+this.businessEndsHour;}else{$Y=this.businessEndsHour-this.businessBeginsHour;}}else if(this.autoHide&&!$W){var $Z=(this.maxEnd-1)*this.cellDuration/this.cellHeight;var $00=Math.ceil($Z/60);$Y=Math.max(this.dayBeginsHour+$00,this.businessEndsHour)-this.visibleStart();}else{if(this.dayBeginsHour>=this.dayEndsHour){$Y=24-this.dayBeginsHour+this.dayEndsHour;}else{$Y=this.dayEndsHour-this.dayBeginsHour;}};return $Y*60*60*1000;};this.message=function($01,$02,$03,$04){if(!$01){return;};var $02=$02||2000;var $03=$03||"#ffffff";var $04=$04||"#000000";var $05=0.8;var $06;if(!this.nav.message){$06=document.createElement("div");$06.style.position="absolute";$06.style.width="100%";$06.style.left="0px";$06.style.textAlign="left";$06.style.top=(this.totalHeaderHeight()+2)+"px";$06.style.opacity=$05;$06.style.filter="alpha(opacity="+($05*100)+")";$06.style.display='none';var $07=document.createElement("div");$07.style.marginLeft=(this.hourWidth+2)+"px";if(this.nav.cornerRight){$07.style.marginRight=DayPilot.sw($b.nav.scroll)+"px";};$07.style.padding="5px";$06.appendChild($07);var close=document.createElement("div");close.style.top="5px";close.style.right=(DayPilot.sw($b.nav.scroll)+5)+"px";close.style.color=$03;close.style.lineHeight="100%";close.style.position="absolute";close.style.cursor="pointer";close.style.fontWeight="bold";close.innerHTML="X";close.onclick=function(){$b.nav.message.style.display='none';};$06.appendChild(close);this.nav.top.insertBefore($06,this.nav.loading);this.nav.message=$06;this.nav.messageClose=close;}else{this.nav.message.style.top=(this.totalHeaderHeight()+2)+"px";};var $08=function(){$b.nav.message.style.opacity=$05;var $07=$b.nav.message.firstChild;$07.style.backgroundColor=$04;$07.style.color=$03;$07.innerHTML=$01;var end=function(){$b.messageTimeout=setTimeout($b.hideMessage,$02);};DayPilot.fade($b.nav.message,0.2,end);};if(this.nav.message.style.display!=='none'){clearTimeout($b.messageTimeout);DayPilot.fade($b.nav.message,-0.2,$08);}else{$08();}};this.hideMessage=function(){var end=function(){$b.nav.message.style.display='none';};DayPilot.fade($b.nav.message,-0.2,end);};this.hideMessageNow=function(){if(this.nav.message){this.nav.message.style.display='none';}};this.updateMessagePosition=function(){if(this.nav.message){this.nav.message.style.top=(this.totalHeaderHeight()+2)+"px";}};this.rowCount=function(){return this.duration()/(60*1000*this.cellDuration);};this.eventClickPostBack=function(e,$y){this.postBack2('EventClick',$y,e);};this.eventClickCallBack=function(e,$y){this.callBack2('EventClick',$y,e);};this.eventClickDispatch=function(){var $06=this;if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($b.eventDoubleClickHandling==='Disabled'){$b.eventClickSingle($06);return;};if(!$b.timeouts){$b.timeouts=[];};var $09=function($06){return function(){$b.eventClickSingle($06);};};$b.timeouts.push(window.setTimeout($09(this),300));};this.eventClickSingle=function($0a){var e=$0a.event;if(!e.clickingAllowed()){return;};switch($b.eventClickHandling){case 'PostBack':$b.eventClickPostBack(e);break;case 'CallBack':$b.eventClickCallBack(e);break;case 'JavaScript':$b.onEventClick(e);break;case 'Edit':if(!e.isAllDay()){$b.divEdit($0a);};break;case 'Select':if(!e.isAllDay()){$b.eventSelect(e);};break;case 'Bubble':if($b.bubble){$b.bubble.showEvent($b.uniqueID,e);};break;case 'ContextMenu':if($0a.data.ContextMenu){var $0b=eval($0a.data.ContextMenu);if($0b){$0b.show(e);}}else{if($b.contextMenu){$b.contextMenu.show(e);}};break;}};this.eventDoubleClickPostBack=function(e,$y){this.postBack2('EventDoubleClick',$y,e);};this.eventDoubleClickCallBack=function(e,$y){this.callBack2('EventDoubleClick',$y,e);};this.eventDoubleClickDispatch=function(){if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if($b.timeouts){for(var $0c in $b.timeouts){window.clearTimeout($b.timeouts[$0c]);};$b.timeouts=null;};var e=this.event;switch($b.eventDoubleClickHandling){case 'PostBack':$b.eventDoubleClickPostBack(e);break;case 'CallBack':$b.eventDoubleClickCallBack(e);break;case 'JavaScript':$b.onEventDoubleClick(e);break;case 'Edit':if(!e.isAllDay()){$b.divEdit(this);};break;case 'Select':if(!e.isAllDay()){$b.eventSelect(e);};break;case 'Bubble':if($b.bubble){$b.bubble.showEvent($b.uniqueID,e);};break;}};this.eventRightClickPostBack=function(e,$y){this.postBack2('EventRightClick',$y,e);};this.eventRightClickCallBack=function(e,$y){this.callBack2('EventRightClick',$y,e);};this.eventRightClickDispatch=function(){var e=this.event;if(!e.rightClickingAllowed()){return false;};switch($b.eventRightClickHandling){case 'PostBack':$b.eventRightClickPostBack(e);break;case 'CallBack':$b.eventRightClickCallBack(e);break;case 'JavaScript':$b.onEventRightClick(e);break;case 'ContextMenu':if(this.data.ContextMenu){eval(this.data.ContextMenu+".show(this.event)");}else{if($b.contextMenu){$b.contextMenu.show(this.event);}};break;case 'Bubble':if($b.bubble){$b.bubble.showEvent($b.uniqueID,e);};break;};return false;};this.headerClickPostBack=function(c,$y){this.postBack2('HeaderClick',$y,c);};this.headerClickCallBack=function(c,$y){this.callBack2('HeaderClick',$y,c);};this.headerClickDispatch=function($e){var $y=this.data;var c=new DayPilotCalendar.Column($y.Value,$y.Name,$y.Start);switch($b.headerClickHandling){case 'PostBack':$b.headerClickPostBack(c);break;case 'CallBack':$b.headerClickCallBack(c);break;case 'JavaScript':$b.onHeaderClick(c);break;}};this.headerMouseMove=function(){if(typeof(DayPilotBubble)!=='undefined'&&$b.columnBubble){if($b.viewType==="Resources"){$b.columnBubble.showResource($b.uniqueID,this.data.Value);}else{var $0d=new DayPilot.Date(this.data.Start);var end=$0d.addDays(1);$b.columnBubble.showTime($b.uniqueID,$0d,end);}}};this.headerMouseOut=function(){if(typeof(DayPilotBubble)!=='undefined'&&$b.columnBubble){$b.columnBubble.hideOnMouseOut();}};this.eventDeletePostBack=function(e,$y){this.postBack2('EventDelete',$y,e);};this.eventDeleteCallBack=function(e,$y){this.callBack2('EventDelete',$y,e);};this.eventDeleteDispatch=function($e){var e=$e.parentNode.parentNode.event;switch($b.eventDeleteHandling){case 'PostBack':$b.eventDeletePostBack(e);break;case 'CallBack':$b.eventDeleteCallBack(e);break;case 'JavaScript':$b.onEventDelete(e);break;}};this.eventResizePostBack=function(e,$0e,$0f,$y){if(!$0e)throw 'newStart is null';if(!$0f)throw 'newEnd is null';var $0g={};$0g.e=e;$0g.newStart=$0e;$0g.newEnd=$0f;this.postBack2('EventResize',$y,$0g);};this.eventResizeCallBack=function(e,$0e,$0f,$y){if(!$0e)throw 'newStart is null';if(!$0f)throw 'newEnd is null';var $0g={};$0g.e=e;$0g.newStart=$0e;$0g.newEnd=$0f;this.callBack2('EventResize',$y,$0g);};this.visibleStart=function($W){if(this.heightSpec==='BusinessHoursNoScroll'){return this.businessBeginsHour;}else if(this.autoHide&&!$W){var $Z=(this.minStart-1)*this.cellDuration/this.cellHeight;var $00=Math.floor($Z/60);return Math.min(this.dayBeginsHour+$00,this.businessBeginsHour);}else{return this.dayBeginsHour;}};this.eventResizeDispatch=function(e,$Q,$P,$n){var $V=1;var $0e=new Date();var $0f=new Date();var $0d=e.start();var end=e.end();var $0h=$b.cellDuration;var $0i=new Date();if($n==='top'){var $0j=$b.columnsBottom[e.div.data.DayIndex].Start;$0i=$0d.getDatePart();var $0k=Math.floor(($P-$V)/$b.cellHeight);var $0l=$0k*$0h;var ts=$0l*60*1000;var $0m=$b.visibleStart()*60*60*1000;$0e=$0j.addTime(ts+$0m);$0f=e.end();}else if($n==='bottom'){var $0j=$b.columnsBottom[e.div.data.DayIndex].Start;$0i=end.getDatePart();var $0k=Math.floor(($P+$Q-$V)/$b.cellHeight);var $0l=$0k*$0h;var ts=$0l*60*1000;var $0m=$b.visibleStart()*60*60*1000;$0e=$0d;$0f=$0j.addTime(ts+$0m);};switch($b.eventResizeHandling){case 'PostBack':$b.eventResizePostBack(e,$0e,$0f);break;case 'CallBack':$b.eventResizeCallBack(e,$0e,$0f);break;case 'JavaScript':$b.onEventResize(e,$0e,$0f);break;}};this.eventMovePostBack=function(e,$0e,$0f,$0n,$y){if(!$0e)throw 'newStart is null';if(!$0f)throw 'newEnd is null';var $0g={};$0g.e=e;$0g.newStart=$0e;$0g.newEnd=$0f;$0g.newResource=$0n;this.postBack2('EventMove',$y,$0g);};this.eventMoveCallBack=function(e,$0e,$0f,$0n,$y){if(!$0e)throw 'newStart is null';if(!$0f)throw 'newEnd is null';var $0g={};$0g.e=e;$0g.newStart=$0e;$0g.newEnd=$0f;$0g.newResource=$0n;this.callBack2('EventMove',$y,$0g);};this.eventMoveDispatch=function(e,$p,$P,ev){var $V=1;var $0k=Math.floor(($P-$V)/$b.cellHeight);var $0h=$b.cellDuration;var $0o=$0k*$0h*60*1000;var $0d=e.start();var end=e.end();var $0i=new Date();if($0d.isDayPilotDate){$0d=$0d.d;};$0i.setTime(Date.UTC($0d.getUTCFullYear(),$0d.getUTCMonth(),$0d.getUTCDate()));var $0p=($b.useEventBoxes!=='Never')?$0d.getTime()-($0i.getTime()+$0d.getUTCHours()*3600*1000+Math.floor($0d.getUTCMinutes()/$0h)*$0h*60*1000):0;var length=end.getTime()-$0d.getTime();var $0m=$b.visibleStart()*3600*1000;var $0q=this.columnsBottom[$p];var $0r=$0q.Start.getTime();var $0s=new Date();$0s.setTime($0r+$0o+$0p+$0m);var $0e=new DayPilot.Date($0s);var $0f=$0e.addTime(length);switch($b.eventMoveHandling){case 'PostBack':$b.eventMovePostBack(e,$0e,$0f,$0q.Value);break;case 'CallBack':$b.eventMoveCallBack(e,$0e,$0f,$0q.Value);break;case 'JavaScript':$b.onEventMove(e,$0e,$0f,$0q.Value,DayPilotCalendar.drag?true:false,ev.ctrlKey,ev.shiftKey);break;}};this.eventBubbleCallBack=function(e,$K){var $J=DayPilot.guid();if(!this.bubbles){this.bubbles=[];};this.bubbles[$J]=$K;var $0g={};$0g.e=e;$0g.guid=$J;this.callBack2("EventBubble",null,$0g);};this.eventMenuClickPostBack=function(e,$0t,$y){var $0g={};$0g.e=e;$0g.command=$0t;this.postBack2('EventMenuClick',$y,$0g);};this.eventMenuClickCallBack=function(e,$0t,$y){var $0g={};$0g.e=e;$0g.command=$0t;this.callBack2('EventMenuClick',$y,$0g);};this.eventMenuClick=function($0t,e,$0u){switch($0u){case 'PostBack':$b.eventMenuClickPostBack(e,$0t);break;case 'CallBack':$b.eventMenuClickCallBack(e,$0t);break;}};this.timeRangeMenuClickPostBack=function(e,$0t,$y){var $0g={};$0g.selection=e;$0g.command=$0t;this.postBack2("TimeRangeMenuClick",$y,$0g);};this.timeRangeMenuClickCallBack=function(e,$0t,$y){var $0g={};$0g.selection=e;$0g.command=$0t;this.callBack2("TimeRangeMenuClick",$y,$0g);};this.timeRangeMenuClick=function($0t,e,$0u){switch($0u){case 'PostBack':$b.timeRangeMenuClickPostBack(e,$0t);break;case 'CallBack':$b.timeRangeMenuClickCallBack(e,$0t);break;}};this.timeRangeSelectedPostBack=function($0d,end,$0v,$y){var $0w={};$0w.start=$0d;$0w.end=end;$0w.resource=$0v;this.postBack2('TimeRangeSelected',$y,$0w);};this.timeRangeSelectedCallBack=function($0d,end,$0v,$y){var $0w={};$0w.start=$0d;$0w.end=end;$0w.resource=$0v;this.callBack2('TimeRangeSelected',$y,$0w);};this.timeRangeSelectedDispatch=function($0d,end,$v){if(!$0d.isDayPilotDate){$0d=new DayPilot.Date($0d);};if(!end.isDayPilotDate){end=new DayPilot.Date(end);};switch($b.timeRangeSelectedHandling){case 'PostBack':$b.timeRangeSelectedPostBack($0d,end,$v);break;case 'CallBack':$b.timeRangeSelectedCallBack($0d,end,$v);break;case 'JavaScript':$b.onTimeRangeSelected($0d,end,$v);break;}};this.timeRangeDoubleClickPostBack=function($0d,end,$v,$y){var $0w={};$0w.start=$0d;$0w.end=end;$0w.resource=$v;this.postBack2('TimeRangeDoubleClick',$y,$0w);};this.timeRangeDoubleClickCallBack=function($0d,end,$v,$y){var $0w={};$0w.start=$0d;$0w.end=end;$0w.resource=$v;this.callBack2('TimeRangeDoubleClick',$y,$0w);};this.timeRangeDoubleClickDispatch=function($0d,end,$v){switch($b.timeRangeDoubleClickHandling){case 'PostBack':$b.timeRangeDoubleClickPostBack($0d,end,$v);break;case 'CallBack':$b.timeRangeDoubleClickCallBack($0d,end,$v);break;case 'JavaScript':$b.onTimeRangeDoubleClick($0d,end,$v);break;}};this.eventEditPostBack=function(e,$0x,$y){var $0g={};$0g.e=e;$0g.newText=$0x;this.postBack2("EventEdit",$y,$0g);};this.eventEditCallBack=function(e,$0x,$y){var $0g={};$0g.e=e;$0g.newText=$0x;this.callBack2("EventEdit",$y,$0g);};this.eventEditDispatch=function(e,$0x){switch($b.eventEditHandling){case 'PostBack':$b.eventEditPostBack(e,$0x);break;case 'CallBack':$b.eventEditCallBack(e,$0x);break;case 'JavaScript':$b.onEventEdit(e,$0x);break;}};this.eventSelectPostBack=function(e,$y){this.postBack2('EventSelect',$y,e);};this.eventSelectCallBack=function(e,$y){this.callBack2('EventSelect',$y,e);};this.eventSelectDispatch=function(){var e=this.selectedEvent();switch($b.eventSelectHandling){case 'PostBack':$b.eventSelectPostBack(e);break;case 'CallBack':__theFormPostData="";__theFormPostCollection=[];WebForm_InitCallback();$b.eventSelectCallBack(e);break;case 'JavaScript':$b.onEventSelect(e);break;}};this.commandCallBack=function($0t,$y){this.stopAutoRefresh();var $0g={};$0g.command=$0t;this.callBack2('Command',$y,$0g);};this.onCellMousedown=function(ev){if(DayPilotCalendar.selecting){return;};if(DayPilotCalendar.editing){DayPilotCalendar.editing.blur();return;};if(DayPilotCalendar.selectedCells&&$b.timeRangeDoubleClickHandling!=='Disabled'){for(var i=0;i<DayPilotCalendar.selectedCells.length;i++){if(this===DayPilotCalendar.selectedCells[i]){return;}}};if($b.timeRangeSelectedHandling==="Disabled"){return;};var $0y=(window.event)?window.event.button:ev.which;if($0y!==1&&$0y!==0){return;};DayPilotCalendar.firstMousePos=DayPilot.mc(ev||window.event);DayPilotCalendar.selecting=true;if(DayPilotCalendar.selectedCells){$b.clearSelection();DayPilotCalendar.selectedCells=[];};DayPilotCalendar.column=DayPilotCalendar.getColumn(this);DayPilotCalendar.selectedCells.push(this);DayPilotCalendar.firstSelected=this;DayPilotCalendar.topSelectedCell=this;DayPilotCalendar.bottomSelectedCell=this;$b.activateSelection();};this.activateSelection=function(){var $0z=this.getSelection();for(var j=0;j<DayPilotCalendar.selectedCells.length;j++){var $f=DayPilotCalendar.selectedCells[j];if($f){$f.style.backgroundColor=$b.selectedColor;$f.selected=true;}}};this.cellMouseOut=function(ev){if(typeof(DayPilotBubble)!=='undefined'&&$b.cellBubble){$b.cellBubble.hideOnMouseOut();}};this.mousemove=function(ev){if(typeof(DayPilotCalendar)==='undefined'){return;};if(typeof(DayPilotBubble)!=='undefined'&&$b.cellBubble){var $v=DayPilotCalendar.getColumn(this);var $0A=$b.columnsBottom[$v].Value;$b.cellBubble.showCell($b.uniqueID,$0A,this.start,this.end);};if(!DayPilotCalendar.selecting){return;};var $i=DayPilot.mc(ev||window.event);var $0B=DayPilotCalendar.getColumn(this);if($0B!==DayPilotCalendar.column){return;};$b.clearSelection();if($i.y<DayPilotCalendar.firstMousePos.y){DayPilotCalendar.selectedCells=DayPilotCalendar.getCellsBelow(this);DayPilotCalendar.topSelectedCell=DayPilotCalendar.selectedCells[0];DayPilotCalendar.bottomSelectedCell=DayPilotCalendar.firstSelected;}else{DayPilotCalendar.selectedCells=DayPilotCalendar.getCellsAbove(this);DayPilotCalendar.topSelectedCell=DayPilotCalendar.firstSelected;DayPilotCalendar.bottomSelectedCell=DayPilotCalendar.selectedCells[0];};$b.activateSelection();};this.getSelection=function(){var $0d=DayPilotCalendar.topSelectedCell.start;var end=DayPilotCalendar.bottomSelectedCell.end;var $0C=DayPilotCalendar.topSelectedCell.resource;return new DayPilot.Selection($0d,end,$0C,$b);};this.mouseup=function(ev){if(DayPilotCalendar.selecting&&DayPilotCalendar.topSelectedCell!==null){$b.divDeselectAll();DayPilotCalendar.selecting=false;var $0D=$b.getSelection();$b.timeRangeSelectedDispatch($0D.start,$0D.end,$0D.resource);if($b.timeRangeSelectedHandling!=="Hold"&&$b.timeRangeSelectedHandling!=="HoldForever"){$a();}}else{DayPilotCalendar.selecting=false;}};this.scroll=function(ev){if(!$b.initScrollPos)return;$b.scrollPos=$b.nav.scroll.scrollTop;$b.scrollHeight=$b.nav.scroll.clientHeight;$b.nav.scrollpos.value=$b.scrollPos;$b.updateScrollLabels();};this.updateScrollLabels=function(){if(!this.scrollLabelsVisible){return;};if(!this.scrollLabels){return;};var $0E=this.columnsBottom;var $0F=(this.showHours?this.hourWidth:0);var $U=(this.nav.scroll.clientWidth-$0F)/$0E.length;for(var i=0;i<$0E.length;i++){var $0G=this.nav.scrollUp[i];var $0H=this.nav.scrollDown[i];$0G.style.left=($0F+2+i*$U+$U/2)+"px";$0H.style.left=($0F+2+i*$U+$U/2)+"px";};var $0I=this.autoHiddenPixels();for(var i=0;i<this.nav.scrollUp.length;i++){var up=this.nav.scrollUp[i];var $0J=this.nav.scrollDown[i];var $0K=this.scrollLabels[i].minEnd-$0I;var $0L=this.scrollLabels[i].maxStart-$0I;if(up&&$0J){if($0K<=$b.scrollPos){up.style.top=(this.totalHeaderHeight()+2)+"px";up.style.display='';}else{up.style.display='none';};if($0L>=$b.scrollPos+$b.scrollHeight){$0J.style.top=(this.totalHeaderHeight()+this.scrollHeight-8)+"px";$0J.style.display='';}else{$0J.style.display='none';}}}};this.createEdit=function($e){var $h=$e.parentNode;while($h&&$h.tagName!=="TD"){$h=$h.parentNode;};var $0M=document.createElement('textarea');$0M.style.position='absolute';$0M.style.width=($e.parentNode.offsetWidth-2)+'px';$0M.style.height=($e.offsetHeight-2)+'px';var $0N=DayPilot.gs($e,'fontFamily');if(!$0N)$0N=DayPilot.gs($e,'font-family');$0M.style.fontFamily=$0N;var $0O=DayPilot.gs($e,'fontSize');if(!$0O)$0O=DayPilot.gs($e,'font-size');$0M.style.fontSize=$0O;$0M.style.left='0px';$0M.style.top=$e.offsetTop+'px';$0M.style.border='1px solid black';$0M.style.padding='0px';$0M.style.marginTop='0px';$0M.style.backgroundColor='white';$0M.value=DayPilot.tr($e.event.text());$0M.event=$e.event;$h.firstChild.appendChild($0M);return $0M;};this.divDeselect=function($0P){$0P.parentNode.removeChild($0P.top);$0P.parentNode.removeChild($0P.bottom);};this.divDeselectAll=function(){var a=$b.selectedEvents;while(a.length>0){var e=a.pop();$b.divDeselect(e);}};this.divSelectOne=function($0P){var w=5;$0P.b=1;$b.selectedEvents.push($0P);var top=document.createElement("div");top.unselectable='on';top.style.position='absolute';top.style.left=$0P.offsetLeft+'px';top.style.width=$0P.offsetWidth+'px';top.style.top=($0P.offsetTop-w)+'px';top.style.height=w+'px';top.style.backgroundColor=$b.eventSelectColor;top.style.zIndex=100;$0P.parentNode.appendChild(top);$0P.top=top;var $0Q=document.createElement("div");$0Q.unselectable='on';$0Q.style.position='absolute';$0Q.style.left=$0P.offsetLeft+'px';$0Q.style.width=$0P.offsetWidth+'px';$0Q.style.top=($0P.offsetTop+$0P.offsetHeight)+'px';$0Q.style.height=w+'px';$0Q.style.backgroundColor=$b.eventSelectColor;$0Q.style.zIndex=100;$0P.parentNode.appendChild($0Q);$0P.bottom=$0Q;};this.cleanEventSelection=function(){$b.divDeselectAll();$b.nav.select.value=null;};this.eventSelect=function(e){var a=$b.selectedEvents;var hs=$b.nav.select;var s=true;if(a.length>0&&a[0]===e.div){s=false;};$b.divDeselectAll();if(s){if($b.eventSelectHandling==="JavaScript"){$b.divSelectOne(e.div);};hs.value=e.div.event.value();}else{hs.value=null;};$b.eventSelectDispatch();};this.selectedEvent=function(){var a=$b.selectedEvents;if(a.length<=0){return null;};if(a.length===1){return a[0].event;};return null;};this.divEdit=function($e){if(DayPilotCalendar.editing){DayPilotCalendar.editing.blur();return;};var $0M=this.createEdit($e);DayPilotCalendar.editing=$0M;$0M.onblur=function(){var id=$e.event.value();var $0R=$e.event.tag();var $0S=$e.event.text();var $0x=$0M.value;DayPilotCalendar.editing=null;$0M.parentNode.removeChild($0M);if($0S===$0x){return;};$e.style.display='none';$b.eventEditDispatch($e.event,$0x);};$0M.onkeypress=function(e){var $0T=(window.event)?event.keyCode:e.keyCode;if($0T===13){this.onblur();return false;}else if($0T===27){$0M.parentNode.removeChild($0M);DayPilotCalendar.editing=false;};return true;};$0M.select();$0M.focus();};this.prepareColumns=function(){if(!this.columns){this.createDaysViewColumns();};this.activateColumnCollection(this.columns);this.columnsBottom=this.columns.getColumns(this.headerLevels,true);};this.createDaysViewColumns=function(){this.columns=[];var $0d=this.startDate.getDatePart();if(this.heightSpec==='BusinessHoursNoScroll'){$0d=$0d.addHours(this.businessBeginsHour);};for(var i=0;i<this.days;i++){var $v={};$v.Start=$0d.addDays(i);$v.Name=$v.Start.toString();$v.InnerHTML=$v.Name;this.columns.push($v);}};this.activateColumn=function($v){$v.Start=new DayPilot.Date($v.Start);$v.getChildren=function($0U,$0V){var $0W=[];if($0U<=1){$0W.push(this);return $0W;};if(!this.Children||this.Children.length===0){if($0V){$0W.push(this);}else{$0W.push("empty");};return $0W;};for(var i=0;i<this.Children.length;i++){var $0X=this.Children[i];var $0Y=$0X.getChildren($0U-1,$0V);for(var j=0;j<$0Y.length;j++){$0W.push($0Y[j]);}};return $0W;};$v.getChildrenCount=function($0U){var $0Z=0;if(!this.Children||this.Children.length<=0||$0U<=1){return 1;};for(var i=0;i<this.Children.length;i++){$0Z+=this.Children[i].getChildrenCount($0U-1);};return $0Z;};$v.putIntoBlock=function(ep){for(var i=0;i<this.blocks.length;i++){var $10=this.blocks[i];if($10.overlapsWith(ep.Top,ep.Height)){$10.events.push(ep);$10.min=Math.min($10.min,ep.Top);$10.max=Math.max($10.max,ep.Top+ep.Height);return i;}};var $10=[];$10.lines=[];$10.events=[];$10.overlapsWith=function($0d,$11){var end=$0d+$11-1;if(!(end<this.min||$0d>this.max-1)){return true;};return false;};$10.putIntoLine=function(ep){var $12=this;for(var i=0;i<this.lines.length;i++){var $13=this.lines[i];if($13.isFree(ep.Top,ep.Height)){$13.push(ep);return i;}};var $13=[];$13.isFree=function($0d,$11){var end=$0d+$11-1;var $W=this.length;for(var i=0;i<$W;i++){var e=this[i];if(!(end<e.Top||$0d>e.Top+e.Height-1)){return false;}};return true;};$13.push(ep);this.lines.push($13);return this.lines.length-1;};$10.events.push(ep);$10.min=ep.Top;$10.max=ep.Top+ep.Height;this.blocks.push($10);return this.blocks.length-1;};$v.putIntoLine=function(ep){var $12=this;for(var i=0;i<this.lines.length;i++){var $13=this.lines[i];if($13.isFree(ep.Top,ep.Height)){$13.push(ep);return i;}};var $13=[];$13.isFree=function($0d,$11){var end=$0d+$11-1;var $W=this.length;for(var i=0;i<$W;i++){var e=this[i];if(!(end<e.Top||$0d>e.Top+e.Height-1)){return false;}};return true;};$13.push(ep);this.lines.push($13);return this.lines.length-1;};if($v.Children){this.activateColumnCollection($v.Children);}};this.activateColumnCollection=function(cc){for(var i=0;i<cc.length;i++){this.activateColumn(cc[i]);};cc.getColumns=function($0U,$0V){var $0W=[];for(var i=0;i<this.length;i++){var $G=this[i].getChildren($0U,$0V);for(var j=0;j<$G.length;j++){$0W.push($G[j]);}};return $0W;};cc.getColumnCount=function($0U){var $0Z=0;for(var i=0;i<this.length;i++){$0Z+=this[i].getChildrenCount($0U);};return $0Z;};};this.drawEventsAllDay=function(){if(!this.showAllDayEvents){return;};var $14=this.nav.header;$14.style.display='none';var $0E=this.columnsBottom.length;for(var j=0;j<this.allDay.lines.length;j++){var $13=this.allDay.lines[j];for(var i=0;i<$13.length;i++){var $y=$13[i];var $06=document.createElement("div");$06.data=$y;$06.unselectable='on';$06.style.position='absolute';$06.style.left=(100.0*$y.ColStart/$0E)+"%";$06.style.width=(100.0*$y.ColWidth/$0E)+"%";$06.style.height=this.allDayEventHeight+'px';$06.style.top=(4+this.headerLevels*this.headerHeight+j*(this.allDayEventHeight+2))+"px";$06.style.textAlign='left';$06.style.lineHeight="1.2";if($y.ClickEnabled){$06.onclick=this.eventClickDispatch;};if($y.DoubleClickEnabled){$06.ondblclick=this.eventDoubleClickDispatch;};$06.oncontextmenu=this.eventRightClickDispatch;if(this.bubble){$06.onmouseout=function(){$b.bubble.hideOnMouseOut();};};if(this.showToolTip){$06.title=$y.ToolTip;};var back=$y.BackgroundColor;var $07=document.createElement("div");$07.unselectable='on';$07.style.marginLeft='2px';$07.style.marginRight='3px';$07.style.paddingLeft='2px';$07.style.height=(this.allDayEventHeight-2)+'px';$07.style.border='1px solid '+this.allDayEventBorderColor;$07.style.overflow='hidden';$07.style.position='relative';$07.style.backgroundColor=back;$07.className=this.applyCssClass("alldayevent");if(this.roundedCorners){$07.style.MozBorderRadius="5px";$07.style.webkitBorderRadius="5px";$07.style.borderRadius="5px";};var $15=[];var $16=true;var $17=this.showAllDayEventStartEnd;var $18=this.showAllDayEventStartEnd;var $19="Center";var $1a=0;var $1b=$y.Start.getTime()===$y.PartStart.getTime();var $1c=$y.End.getTime()===$y.PartEnd.getTime();if($17){if($19==='Left'){$15.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:8pt;color:gray;text-align:right;");$15.push("width:");$15.push($1a-4);$15.push("px;");$15.push("><span style='background-color:");}else{$15.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:8pt;color:gray'><span style='background-color:");};$15.push('transparent');$15.push("' unselectable='on'>");if($1b){if($y.Start.getDatePart().getTime()!==$y.Start.getTime()){$15.push(DayPilot.Date.hours($y.Start.d,this.timeFormat==='Clock12Hours'));}}else{$15.push("~");};$15.push("</span></div></div>");};if($18){$15.push("<div unselectable='on' style='position:absolute;text-align:right;height:1px;font-size:1px;width:100%'><div unselectable='on' style='margin-right:4px;font-size:8pt;color:gray'><span style='background-color:");$15.push('transparent');$15.push("' unselectable='on'>");if($1c){if($y.End.getDatePart().getTime()!==$y.End.getTime()){$15.push(DayPilot.Date.hours($y.End.d,this.timeFormat==='Clock12Hours'));}}else{$15.push("~");};$15.push("</span></div></div>");};if($19==='Left'){var $1d=$17?$1a:0;$15.push("<div style='margin-top:0px;height:");$15.push(this.allDayEventHeight-2);$15.push("px;");$15.push(";overflow:hidden;text-align:left;padding-left:");$15.push($1d);$15.push("px;font-size:");$15.push(this.allDayEventFontSize);$15.push(";color:");$15.push(this.allDayEventFontColor);$15.push(";font-family:");$15.push(this.eventFontFamily);$15.push("' unselectable='on'>");if($y.InnerHTML){$15.push($y.InnerHTML);}else{$15.push($y.Text);};$15.push("</div>");}else if($19==='Center'){if($16){$15.push("<div style='position:absolute; text-align:center; width: 98%; height:1px;'>");$15.push("<span style='background-color:");$15.push('transparent');$15.push(";font-size:");$15.push(this.allDayEventFontSize);$15.push(";color:");$15.push(this.allDayEventFontColor);$15.push(";font-family:");$15.push(this.allDayEventFontFamily);$15.push("' unselectable='on'>");if($y.InnerHTML){$15.push($y.InnerHTML);}else{$15.push($y.Text);};$15.push("</span>");$15.push("</div>");}else{$15.push("<div style='margin-top:0px;height:");$15.push(this.allDayEventHeight-2);$15.push("px;");$15.push(";overflow:hidden;text-align:center;font-size:");$15.push(this.allDayEventFontSize);$15.push(";color:");$15.push(this.allDayEventFontColor);$15.push(";font-family:");$15.push(this.allDayEventFontFamily);$15.push("' unselectable='on'>");if($y.InnerHTML){$15.push($y.InnerHTML);}else{$15.push($y.Text);};$15.push("</div>");}};$07.innerHTML=$15.join('');$06.appendChild($07);this.nav.allday.appendChild($06);new DayPilotCalendar.Event($06,$b);this.elements.events.push($06);}};$14.style.display='';};this.deleteEvents=function(){if(this.elements.events){for(var i=0;i<this.elements.events.length;i++){var $06=this.elements.events[i];var $e=$06.event;if($e){$e.div=null;$e.root=null;};$06.onclick=null;$06.onclickSave=null;$06.ondblclick=null;$06.oncontextmenu=null;$06.onmouseover=null;$06.onmouseout=null;$06.onmousemove=null;$06.onmousedown=null;if($06.firstChild&&$06.firstChild.firstChild&&$06.firstChild.firstChild.tagName&&$06.firstChild.firstChild.tagName.toUpperCase()==='IMG'){var $1e=$06.firstChild.firstChild;$1e.onmousedown=null;$1e.onmousemove=null;$1e.onclick=null;};$06.data=null;$06.event=null;DayPilot.de($06);}};this.elements.events=[];};this.drawEvent=function($y){var $T=this.nav.main;var $1f=this.roundedCorners;var $1g=this.roundedCorners&&(this.ff||this.opera105||this.webkit522||this.ie9);var $1h=this.roundedCorners&&!$1g;var $1i=$y.BorderColor;var $06=document.createElement("div");$06.data=$y;$06.unselectable='on';$06.style.MozUserSelect='none';$06.style.KhtmlUserSelect='none';$06.style.position='absolute';$06.style.fontFamily=this.eventFontFamily;$06.style.fontSize=this.eventFontSize;$06.style.color=$y.FontColor;$06.style.left=$y.Left+'%';$06.style.top=($y.Top-this.autoHiddenPixels())+'px';$06.style.width=$y.Width+'%';$06.style.height=Math.max($y.Height,2)+'px';if(!$1f){$06.style.backgroundColor=$1i;};$06.style.overflow='hidden';if(this.transparent){$06.style.opacity=0.6;$06.style.filter="alpha(opacity=60)";};$06.isFirst=$y.PartStart.getTime()===$y.Start.getTime();$06.isLast=$y.PartEnd.getTime()===$y.End.getTime();if($y.ClickEnabled){$06.onclick=this.eventClickDispatch;};if($y.DoubleClickEnabled){$06.ondblclick=this.eventDoubleClickDispatch;};$06.oncontextmenu=this.eventRightClickDispatch;if(this.bubble){$06.onmouseout=function(){$b.bubble.hideOnMouseOut();};};var $15=[];if(this.eventDeleteHandling!=='Disabled'&&$y.DeleteEnabled){$15.push("<div unselectable='on' style='position:absolute; width:100%;text-align:right;'><div style='position:absolute; width:10px; height:10px; right:2px; top: 2px; cursor:pointer;");if(this.deleteImageUrl){$15.push("background-image:url(\"" + this.deleteImageUrl + "\");");};$15.push("' class='");$15.push(this.applyCssClass("event_delete"));$15.push("' onmousemove=\"if(typeof(DayPilotBubble)!=='undefined'&&");$15.push(this.clientName);$15.push(".bubble && ");$15.push(this.clientName);$15.push(".bubble.hideAfter > 0");$15.push(") { DayPilotBubble.hideActive(); event.cancelBubble = true; };\" onmousedown=\"this.parentNode.parentNode.style.cursor='default';\" onclick='");$15.push(this.clientName);$15.push(".eventDeleteDispatch(this); event.cancelBubble = true; if (event.stopPropagation) event.stopPropagation();' ></div></div>");};if($1h){$15.push("<div style='margin-right:2px;'>");$15.push("<div style='height:1px;line-height:1px;font-size:0px; margin-left:2px; background-color:");$15.push($1i);$15.push(";'>&nbsp;</div>");$15.push("</div>");$15.push("<div unselectable='on' style='position:absolute;width:100%;margin-top:-1px;'>");$15.push("<div style='height:1px;line-height:1px;font-size:0px;margin-left:1px;margin-top:1px; margin-right:1px;border-right:1px solid ");$15.push($1i);$15.push(";border-left:1px solid ");$15.push($1i);$15.push(";background-color:");$15.push($y.Header?$1i:$y.BackgroundColor);$15.push("'>");$15.push("&nbsp;</div>");$15.push("</div>");}else if(!$1g){$15.push("<div style='height:1px;line-height:1px;font-size:0px; width:1px;'>&nbsp;</div>");};$15.push("<div");if(this.showToolTip){$15.push(" title='");$15.push($y.ToolTip.replace(/'/g,"&apos;"));$15.push("'");};var $m=Math.max($y.Height-2,0);$15.push(" class='");$15.push($y.CssClass?$y.CssClass:this.applyCssClass('event'));$15.push("'");if($1h){$15.push(" style='margin-top:1px;height:");$15.push($m-2);}else{$15.push(" style='margin-top:0px;height:");$15.push($m);};$15.push("px;background-color:");$15.push($y.BackgroundColor);if($1g){$15.push(";border:1px solid ");$15.push($1i);$15.push(";-moz-border-radius:5px;");$15.push(";-webkit-border-radius:5px;");$15.push(";border-radius:5px;");}else{$15.push(";border-left:1px solid ");$15.push($1i);$15.push(";border-right:1px solid ");$15.push($1i);};$15.push(";");if($y.BackgroundImage){$15.push("background-image:url(");$15.push($y.BackgroundImage);$15.push(");");if($y.BackgroundRepeat){$15.push("background-repeat:");$15.push($y.BackgroundRepeat);$15.push(";");}};if($b.rtl){$15.push("direction:rtl;");};$15.push("' unselectable='on'>");if(this.durationBarVisible){$15.push("<div style='position:absolute;left:1px;top:1px;width:");$15.push($b.durationBarWidth-1);$15.push("px;height:");$15.push($y.BarTop);$15.push("px;background-color:white;font-size:1px' unselectable='on'></div>");$15.push("<div style='position:absolute;left:1px;top:");$15.push($y.BarTop+$y.BarHeight);$15.push("px;width:");$15.push($b.durationBarWidth-1);$15.push("px;height:");$15.push($m-($y.BarTop+$y.BarHeight));$15.push("px;background-color:white;font-size:1px' unselectable='on'></div>");$15.push("<div style='position:absolute;left:1px;width:");$15.push($b.durationBarWidth);$15.push("px;height:");$15.push($y.BarHeight);$15.push("px;");if($y.DurationBarImageUrl){$15.push("background-image:url(");$15.push($y.DurationBarImageUrl);$15.push(");");}else if($b.durationBarImageUrl){$15.push("background-image:url(");$15.push($b.durationBarImageUrl);$15.push(");");};$15.push("top:");$15.push($y.BarTop+1);$15.push("px;background-color:");$15.push($y.BarColor);$15.push(";font-size:1px' unselectable='on'></div><div style='position:absolute;left:");$15.push($b.durationBarWidth);$15.push("px;top:1px;width:1px;background-color:");$15.push($1i);$15.push(";height:100%' unselectable='on'></div>");};var $1j=$y.Header?this.eventHeaderHeight:0;if($y.Header){$15.push("<div unselectable='on' style='overflow:hidden;height:");$15.push(this.eventHeaderHeight);$15.push("px; background-color:");$15.push($1i);$15.push(";font-size:");$15.push(this.eventHeaderFontSize);$15.push(";color:");$15.push(this.eventHeaderFontColor);$15.push("'>");$15.push($y.Header);$15.push("</div>");};if(this.durationBarVisible){$15.push("<div unselectable='on' style='padding-left:");$15.push($b.durationBarWidth+3);$15.push("px;");$15.push("'>");}else{$15.push("<div unselectable='on' style='overflow:hidden;padding-left:2px;height:");$15.push($m-$1j-1);$15.push("px;'>");};$15.push($y.InnerHTML);$15.push("</div></div>");if($1h){$15.push("<div unselectable='on' style='margin-right:2px;'>");$15.push("<div unselectable='on' style='height:1px;line-height:1px;font-size:0px;margin-left:2px;margin-top:1px;background-color:");$15.push($1i);$15.push(";'><!-- --></div>");$15.push("</div>");$15.push("<div unselectable='on' style='margin-right:0px;margin-top:-3px;position:relative;'>");$15.push("<div unselectable='on' style='margin-right:0px;position:relative;'>");$15.push("<div unselectable='on' style='height:1px;line-height:1px;font-size:0px;margin-top:1px;margin-left:1px;margin-right:1px;border-right:1px solid ");$15.push($1i);$15.push(";border-left:1px solid ");$15.push($1i);$15.push(";background-color:");$15.push($y.BackgroundColor);$15.push("'>");$15.push("<!-- --></div>");$15.push("</div>");$15.push("</div>");};$06.innerHTML=$15.join('');if($T.rows[0].cells[$y.DayIndex]){var $1k=$T.rows[0].cells[$y.DayIndex].firstChild;$1k.appendChild($06);$b.makeChildrenUnselectable($06);var e=new DayPilotCalendar.Event($06,$b);if($b.afterEventRender){$b.afterEventRender(e,$06);}};$b.elements.events.push($06);};this.relativizeChildren=function(el){var c=(el&&el.childNodes)?el.childNodes.length:0;for(var i=0;i<c;i++){var $0X=el.childNodes[i];if($0X.style.position===''){$0X.style.position='relative';};this.relativizeChildren($0X);}};this.makeChildrenUnselectable=function(el){var c=(el&&el.childNodes)?el.childNodes.length:0;for(var i=0;i<c;i++){try{var $0X=el.childNodes[i];if($0X.nodeType===1){$0X.unselectable='on';this.makeChildrenUnselectable($0X);}}catch(e){}}};this.drawEvents=function(){this.selectedEvents=[];var $0d=new Date();for(var i=0;i<this.columnsBottom.length;i++){var $1l=this.columnsBottom[i];for(var m=0;m<$1l.blocks.length;m++){var $10=$1l.blocks[m];for(var j=0;j<$10.lines.length;j++){var $13=$10.lines[j];for(var k=0;k<$13.length;k++){var e=$13[k];e.Width=100/$10.lines.length;e.Left=e.Width*j;if(this.eventArrangement==='Cascade'){var $1m=(j===$10.lines.length-1);if(!$1m){e.Width=e.Width*1.5;}};if(this.eventArrangement==='Full'){e.Left=e.Left/2;e.Width=100-e.Left;};if(!e.AllDay){this.bg?this.drawEvent2(e):this.drawEvent(e);}}}}};var end=new Date();var $1n=end.getTime()-$0d.getTime();};this.drawEventsFromLines=function(){this.selectedEvents=[];for(var i=0;i<this.columnsBottom.length;i++){var $1l=this.columnsBottom[i];for(var j=0;j<$1l.lines.length;j++){var $13=$1l.lines[j];for(var k=0;k<$13.length;k++){var e=$13[k];e.Width=100/$1l.lines.length;e.Left=e.Width*j;if(!e.AllDay){this.drawEvent(e);}}}}};this.applyCssClass=function($1o){if(this.cssClassPrefix){return this.cssClassPrefix+$1o;}else{return "";}};this.drawTop=function(){this.nav.top=document.getElementById(this.id);this.nav.top.innerHTML='';this.nav.top.style.MozUserSelect='none';this.nav.top.style.KhtmlUserSelect='none';this.nav.top.style.position='relative';this.nav.top.style.width=this.width?this.width:'100%';this.nav.top.style.lineHeight="1.2";this.nav.top.style.textAlign="left";if(this.heightSpec==="Parent100Pct"){this.nav.top.style.height="100%";};if(this.showHeader){var $14=this.drawTopHeaderDiv();this.nav.top.appendChild($14);};this.nav.scroll=document.createElement("div");this.nav.scroll.style.height=this.getScrollableHeight()+"px";if(this.heightSpec==="Fixed"){this.nav.scroll.style.overflowY="scroll";}else if(this.heightSpec!=="Full"&&this.heightSpec!=="BusinessHoursNoScroll"){this.nav.scroll.style.overflow="auto";}else{this.nav.scroll.style.overflow="hidden";};this.nav.scroll.style.position="relative";this.nav.scroll.style.border="1px solid "+this.borderColor;this.nav.scroll.style.backgroundColor=this.hourNameBackColor;this.nav.scroll.style.zoom=1;var $1p=this.drawScrollable();this.nav.scrollable=$1p.firstChild;this.nav.scroll.appendChild($1p);this.nav.top.appendChild(this.nav.scroll);this.nav.vsph=document.createElement("div");this.nav.vsph.style.display="none";this.nav.top.appendChild(this.nav.vsph);this.nav.scrollpos=document.createElement("input");this.nav.scrollpos.type="hidden";this.nav.scrollpos.id=$b.id+"_scrollpos";this.nav.scrollpos.name=this.nav.scrollpos.id;this.nav.top.appendChild(this.nav.scrollpos);this.nav.select=document.createElement("input");this.nav.select.type="hidden";this.nav.select.id=$b.id+"_select";this.nav.select.name=this.nav.select.id;this.nav.select.value=null;this.nav.top.appendChild(this.nav.select);this.nav.scrollLayer=document.createElement("div");this.nav.scrollLayer.style.position='absolute';this.nav.scrollLayer.style.top='0px';this.nav.scrollLayer.style.left='0px';this.nav.top.appendChild(this.nav.scrollLayer);this.nav.scrollUp=[];this.nav.scrollDown=[];this.nav.loading=document.createElement("div");this.nav.loading.style.position='absolute';this.nav.loading.style.top='0px';this.nav.loading.style.left=(this.hourWidth+5)+"px";this.nav.loading.style.backgroundColor=this.loadingLabelBackColor;this.nav.loading.style.fontSize=this.loadingLabelFontSize;this.nav.loading.style.fontFamily=this.loadingLabelFontFamily;this.nav.loading.style.color=this.loadingLabelFontColor;this.nav.loading.style.padding='2px';this.nav.loading.innerHTML=this.loadingLabelText;this.nav.loading.style.display='none';this.nav.top.appendChild(this.nav.loading);};this.drawHourTable=function(){if(!this.fasterDispose)DayPilot.pu(this.nav.hourTable);this.nav.scrollable.rows[0].cells[0].innerHTML='';this.nav.hourTable=this.createHourTable();this.nav.scrollable.rows[0].cells[0].appendChild(this.nav.hourTable);};this.drawScrollable=function(){var $1q=document.createElement("div");$1q.style.zoom=1;$1q.style.position='relative';var $1r=document.createElement("table");$1r.cellSpacing="0";$1r.cellPadding="0";$1r.border="0";$1r.style.border="0px none";$1r.style.width="100%";$1r.style.position='absolute';var r=$1r.insertRow(-1);var c;if(this.showHours){c=r.insertCell(-1);c.valign="top";c.style.padding='0px';c.style.border='0px none';this.nav.hourTable=this.createHourTable();c.appendChild(this.nav.hourTable);};c=r.insertCell(-1);c.valign="top";c.width="100%";c.style.padding='0px';c.style.border='0px none';c.appendChild(this.createEventsAndCells());$1q.appendChild($1r);var $m=(this.duration()*this.cellHeight)/(60000*this.cellDuration);this.nav.zoom=$1q;return $1q;};this.createEventsAndCells=function(){var $1r=document.createElement("table");$1r.cellPadding="0";$1r.cellSpacing="0";$1r.border="0";$1r.style.width="100%";$1r.style.border="0px none";$1r.style.borderLeft="1px solid "+this.borderColor;this.nav.main=$1r;return $1r;};this.createHourTable=function(){var $1r=document.createElement("table");$1r.cellSpacing="0";$1r.cellPadding="0";$1r.border="0";$1r.style.border='0px none';$1r.style.width=this.hourWidth+"px";$1r.oncontextmenu=function(){return false;};var r=$1r.insertRow(-1);r.style.height="1px";r.style.backgroundColor="white";var c=r.insertCell(-1);c.style.padding='0px';c.style.border='0px none';var $1s=this.duration()/(60*60*1000);var $0d=this.visibleStart();this.debug("start: "+$0d);this.debug("hours: "+$1s);for(var i=0;i<$1s;i++){this.createHourRow($1r,i);};return $1r;};this.autoHiddenRows=function(){return(this.visibleStart()-this.visibleStart(true))*(60/this.cellDuration);};this.autoHiddenHours=function(){return(this.visibleStart()-this.visibleStart(true));};this.autoHiddenPixels=function(){return this.autoHiddenRows()*this.cellHeight;};this.createHourRow=function($1r,i){var $m=(this.cellHeight*60/this.cellDuration);var r=$1r.insertRow(-1);r.style.height=$m+"px";var c=r.insertCell(-1);c.valign="bottom";c.unselectable="on";c.className=this.applyCssClass("rowheader");c.style.backgroundColor=this.hourNameBackColor;c.style.cursor="default";c.style.padding='0px';c.style.border='0px none';var $1t=document.createElement("div");$1t.style.width=this.hourWidth+"px";$1t.style.height=($m)+"px";$1t.style.overflow='hidden';$1t.unselectable='on';var $10=document.createElement("div");$10.style.display="block";$10.style.borderBottom="1px solid "+this.hourNameBorderColor;$10.style.height=($m-1)+"px";$10.style.textAlign="right";$10.unselectable="on";if(this.hours){$10.innerHTML=this.hours[i+this.autoHiddenHours()].HTML;}else{var $r=document.createElement("div");$r.style.padding="2px";$r.style.fontFamily=this.hourFontFamily;$r.style.fontSize=this.hourFontSize;$r.style.color=this.hourFontColor;$r.unselectable="on";var $0d=this.startDate.addHours(i+this.visibleStart());var $1u=$0d.getHours();var am=$1u<12;if(this.timeFormat==="Clock12Hours"){$1u=$1u%12;if($1u===0){$1u=12;}};$r.innerHTML=$1u;var $1v=document.createElement("span");$1v.style.fontSize="10px";$1v.style.verticalAlign="super";$1v.unselectable="on";var $1w;if(this.timeFormat==="Clock12Hours"){if(am){$1w="AM";}else{$1w="PM";}}else{$1w="00";};$1v.innerHTML="&nbsp;"+$1w;$r.appendChild($1v);$10.appendChild($r);};$1t.appendChild($10);c.appendChild($1t);};this.getScrollableHeight=function(){switch(this.heightSpec){case "Fixed":return this.height;case "Parent100Pct":return this.height;case "Full":return(this.duration()*this.cellHeight)/(60000*this.cellDuration);case "BusinessHours":case "BusinessHoursNoScroll":var $Y;if(this.businessBeginsHour>this.businessEndsHour){$Y=24-this.businessBeginsHour+this.businessEndsHour;}else{$Y=this.businessEndsHour-this.businessBeginsHour;};return $Y*this.cellHeight*60/this.cellDuration;default:throw "DayPilot.Calendar: Unexpected 'heightSpec' value.";}};this.totalHeaderHeight=function(){var $1x=this.headerLevels*this.headerHeight+this.headerLevels-1;if(this.showAllDayEvents&&this.allDayHeaderHeight){return $1x+this.allDayHeaderHeight+1;}else{return $1x;}};this.drawTopHeaderDiv=function(){var $14=document.createElement("div");$14.style.borderLeft="1px solid "+this.borderColor;$14.style.borderRight="1px solid "+this.borderColor;$14.style.overflow="auto";var $1r=document.createElement("table");$1r.cellPadding="0";$1r.cellSpacing="0";$1r.border="0";$1r.style.width="100%";$1r.style.borderCollapse='separate';$1r.style.border="0px none";var r=$1r.insertRow(-1);var c=r.insertCell(-1);c.style.padding='0px';c.style.border='0px none';if(this.showHours){var $1y=this.drawCorner();c.appendChild($1y);this.nav.corner=$1y;}else{var $1z=document.createElement("div");$1z.style.backgroundColor=this.hourNameBackColor;$1z.style.width="0px";$1z.style.height=this.totalHeaderHeight()+"px";$1z.style.borderTop="1px solid "+this.borderColor;$1z.unselectable="on";c.appendChild($1z);};c=r.insertCell(-1);c.style.width="100%";c.style.backgroundColor=this.hourNameBackColor;c.valign="top";c.style.position='relative';c.style.padding='0px';c.style.border='0px none';if(this.showAllDayEvents){var $1p=document.createElement("div");$1p.style.position='relative';$1p.style.height="0px";$1p.style.lineHeight="0px";$1p.style.fontSize="0px";var $1A=document.createElement("div");$1A.style.position='relative';$1A.style.height="0px";if(DayPilot.isKhtml){$1A.style.marginLeft="2px";};this.nav.allday=$1A;$1p.appendChild($1A);c.appendChild($1p);};this.nav.header=document.createElement("table");this.nav.header.cellPadding="0";this.nav.header.cellSpacing="0";this.nav.header.border="0";this.nav.header.width="100%";this.nav.header.style.borderBottom="0px none #000000";this.nav.header.style.borderRight="0px none #000000";this.nav.header.style.borderLeft="1px solid "+this.borderColor;this.nav.header.style.borderTop="1px solid "+this.borderColor;this.nav.header.oncontextmenu=function(){return false;};if(this.heightSpec!=="Full"&&this.heightSpec!=="BusinessHoursNoScroll"){this.nav.header.style.borderRight="1px solid "+this.borderColor;};c.appendChild(this.nav.header);if(this.heightSpec!=="Full"&&this.heightSpec!=="BusinessHoursNoScroll"){c=r.insertCell(-1);c.className=this.applyCssClass('cornerright');c.style.backgroundColor=this.hourNameBackColor;c.style.borderTop="1px solid "+this.borderColor;c.style.borderBottom="0px none";c.style.borderLeft="0px none";c.style.borderRight="0px none";c.style.padding='0px';c.unselectable="on";c.innerHTML="&nbsp;";var $15=document.createElement("div");$15.unselectable="on";$15.style.width="16px";$15.style.height="1px";$15.style.lineHeight="1px";$15.style.fontSize="1px";c.appendChild($15);this.nav.cornerRight=$15;};$14.appendChild($1r);return $14;};this.drawCorner=function(){var $1p=document.createElement("div");$1p.style.position='relative';$1p.style.backgroundColor=this.cornerBackColor;$1p.style.fontFamily=this.headerFontFamily;$1p.style.fontSize=this.headerFontSize;$1p.style.color=this.headerFontColor;$1p.style.width=this.hourWidth+"px";$1p.style.height=this.totalHeaderHeight()+"px";$1p.style.borderTop="1px solid "+this.borderColor;$1p.className=this.applyCssClass("corner");$1p.oncontextmenu=function(){return false;};var $1y=document.createElement("div");$1y.unselectable="on";$1y.innerHTML=this.cornerHTML?this.cornerHTML:'';$1p.appendChild($1y);if(!this.numberFormat)return $1p;var $1B=document.createElement("div");$1B.style.position='absolute';$1B.style.padding='2px';$1B.style.top='0px';$1B.style.left='1px';$1B.style.backgroundColor="#FF6600";$1B.style.color="white";$1B.innerHTML="\u0044\u0045\u004D\u004F";$1B.unselectable="on";$1p.appendChild($1B);return $1p;};this.disposeMain=function(){var $1r=this.nav.main;$1r.root=null;$1r.onmouseup=null;for(var y=0;y<$1r.rows.length;y++){var r=$1r.rows[y];for(var x=0;x<r.cells.length;x++){var c=r.cells[x];c.root=null;c.onmousedown=null;c.onmousemove=null;c.onmouseout=null;c.onmouseup=null;c.onclick=null;c.ondblclick=null;c.oncontextmenu=null;}};if(!this.fasterDispose)DayPilot.pu($1r);};this.deleteScrollLabels=function(){for(var i=0;this.nav.scrollUp&&i<this.nav.scrollUp.length;i++){this.nav.scrollLayer.removeChild(this.nav.scrollUp[i]);};for(var i=0;this.nav.scrollDown&&i<this.nav.scrollDown.length;i++){this.nav.scrollLayer.removeChild(this.nav.scrollDown[i]);};this.nav.scrollUp=[];this.nav.scrollDown=[];};this.drawMain=function(){DayPilotCalendar.selectedCells=[];var $1C=[];var $1D=[];var $1r=this.nav.main;var $0k=this.cellDuration*60*1000;var $1E=this.rowCount();this.debug("drawMain(), rowCount:"+$1E);var $0E=$b.columnsBottom;var $1F=!this.tableCreated||$0E.length!==$1r.rows[0].cells.length||$1E!==$1r.rows.length;if($1r){this.disposeMain();}while($1r&&$1r.rows&&$1r.rows.length>0&&$1F){if(!this.fasterDispose)DayPilot.pu($1r.rows[0]);$1r.deleteRow(0);};this.tableCreated=true;var r=($1F)?$1r.insertRow(-1):$1r.rows[0];if($1F){r.style.backgroundColor='white';};if(this.scrollLabelsVisible){var $0E=this.columnsBottom;var $0F=(this.showHours?this.hourWidth:0);var $U=(this.nav.scroll.clientWidth-$0F)/$0E.length;for(var i=0;i<$0E.length;i++){var $0G=document.createElement("div");$0G.style.position='absolute';$0G.style.top='0px';$0G.style.left=($0F+2+i*$U+$U/2)+"px";$0G.style.display='none';var $1e=document.createElement("div");$1e.style.height='10px';$1e.style.width='10px';$1e.style.backgroundRepeat="no-repeat";if(this.scrollUpUrl){$1e.style.backgroundImage="url('"+this.scrollUpUrl+"')";};$1e.className=this.applyCssClass("scroll_up");$0G.appendChild($1e);this.nav.scrollLayer.appendChild($0G);this.nav.scrollUp.push($0G);var $0H=document.createElement("div");$0H.style.position='absolute';$0H.style.top='0px';$0H.style.left=($0F+2+i*$U+$U/2)+"px";$0H.style.display='none';var $1e=document.createElement("div");$1e.style.height='10px';$1e.style.width='10px';$1e.style.backgroundRepeat="no-repeat";if(this.scrollDownUrl){$1e.style.backgroundImage="url('"+this.scrollDownUrl+"')";};$1e.className=this.applyCssClass("scroll_down");$0H.appendChild($1e);this.nav.scrollLayer.appendChild($0H);this.nav.scrollDown.push($0H);}};var cl=$0E.length;for(var j=0;j<cl;j++){var c=($1F)?r.insertCell(-1):r.cells[j];if($1F){c.style.padding='0px';c.style.border='0px none';c.style.height='1px';if(!$b.rtl){c.style.textAlign='left';};c.style.width=(100.0/$0E.length)+"%";var $06=document.createElement("div");$06.style.display='block';$06.style.marginRight=$b.columnMarginRight+"px";$06.style.position='relative';$06.style.height='1px';$06.style.fontSize='1px';$06.style.lineHeight='1.2';$06.style.marginTop='-1px';c.appendChild($06);}};for(var i=0;i<$1E;i++){var r=($1F)?$1r.insertRow(-1):$1r.rows[i+1];if($1F){r.style.MozUserSelect='none';r.style.KhtmlUserSelect='none';};for(var j=0;j<cl;j++){var $1l=this.columnsBottom[j];var c=($1F)?r.insertCell(-1):r.cells[j];c.start=$1l.Start.addTime(i*$0k).addHours(this.visibleStart());c.end=c.start.addTime($0k);c.resource=$1l.Value;if($1F){c.root=this;c.style.padding='0px';c.style.border='0px none';c.style.verticalAlign='bottom';c.onmousedown=this.onCellMousedown;c.onmousemove=this.mousemove;c.onmouseout=this.cellMouseOut;c.onmouseup=function(){return false;};c.onclick=function(){return false;};c.ondblclick=function(){if($b.timeRangeDoubleClickHandling==='Disabled'){return;};var $0D=$b.getSelection();$b.timeRangeDoubleClickDispatch($0D.start,$0D.end,$0D.resource);};c.oncontextmenu=function(){if(!this.selected){if(DayPilotCalendar.selectedCells){$b.clearSelection();DayPilotCalendar.selectedCells=[];};DayPilotCalendar.column=DayPilotCalendar.getColumn(this);DayPilotCalendar.selectedCells.push(this);DayPilotCalendar.firstSelected=this;DayPilotCalendar.topSelectedCell=this;DayPilotCalendar.bottomSelectedCell=this;$b.activateSelection();};if($b.contextMenuSelection){$b.contextMenuSelection.show($b.getSelection());};return false;};c.style.fontSize='1px';if((!$b.rtl&&j!==cl-1)||$b.rtl){c.style.borderRight='1px solid '+$b.cellBorderColor;};c.style.height=$b.cellHeight+'px';c.unselectable='on';var $06=document.createElement("div");$06.unselectable='on';$06.style.fontSize='1px';$06.style.height='1px';var $1G=(c.end.getMinutes()+c.end.getSeconds()+c.end.getMilliseconds())>0;if($1G){if($b.hourHalfBorderColor!==''){$06.style.borderBottom='1px solid '+$b.hourHalfBorderColor;};$06.className=$b.applyCssClass("hourhalfcellborder");}else{if($b.hourBorderColor!==''){$06.style.borderBottom='1px solid '+$b.hourBorderColor;};$06.className=$b.applyCssClass("hourcellborder");};c.appendChild($06);};c.originalColor=$b.getColor(j,i);c.className=$b.applyCssClass("cellbackground");c.style.backgroundColor=c.originalColor;}};$1r.onmouseup=this.mouseup;$1r.root=this;var scroll=$b.nav.scroll;$b.nav.scrollable.onmousemove=function(ev){DayPilotCalendar.activeCalendar=this;var $1H=$b.nav.scrollable;$b.coords=DayPilot.mo2($1H,ev);ev=ev||window.event;var $i=DayPilot.mc(ev);if(DayPilotCalendar.resizing){DayPilotCalendar.resizing.dirty=true;var $1I=DayPilotCalendar.resizing.event.root.cellHeight;var $V=1;var $1J=($i.y-DayPilotCalendar.originalMouse.y);if(DayPilotCalendar.resizing.dpBorder==='bottom'){var $1K=Math.floor(((DayPilotCalendar.originalHeight+DayPilotCalendar.originalTop+$1J)+$1I/2) / $1I)*$1I-DayPilotCalendar.originalTop+$V;if($1K<$1I)$1K=$1I;var $W=DayPilotCalendar.resizing.event.root.nav.main.clientHeight;if(DayPilotCalendar.originalTop+$1K>$W)$1K=$W-DayPilotCalendar.originalTop;DayPilotCalendar.resizingShadow.style.height=($1K-4)+'px';}else if(DayPilotCalendar.resizing.dpBorder==='top'){var $1L=Math.floor(((DayPilotCalendar.originalTop+$1J-$V)+$1I/2) / $1I)*$1I+$V;if($1L<$V){$1L=$V;};var $1K=DayPilotCalendar.originalHeight-($1L-DayPilotCalendar.originalTop);if($1K<$1I){$1K=$1I;}else{DayPilotCalendar.resizingShadow.style.top=$1L+'px';};DayPilotCalendar.resizingShadow.style.height=($1K-4)+'px';};if(!$b.allowEventOverlap){$b.overlap=$b.isOverlapping();if($b.overlap){document.body.style.cursor='not-allowed';}else{document.body.style.cursor='n-resize';}}}else if(DayPilotCalendar.moving){DayPilotCalendar.moving.dirty=true;if(!$b.coords){return;};var $1I=$b.cellHeight;var $V=1;var $1M=DayPilotCalendar.moveOffsetY;if(!$1M){$1M=$1I/2;};var $1L=Math.floor((($b.coords.y-$1M-$V)+$1I/2) / $1I)*$1I+$V;if($1L<$V){$1L=$V;};var $T=$b.nav.main;var $W=$T.clientHeight;if($1L+DayPilotCalendar.moving.height>$W){$1L=$W-DayPilotCalendar.moving.height;};DayPilotCalendar.movingShadow.parentNode.style.display='none';DayPilotCalendar.movingShadow.style.top=$1L+'px';DayPilotCalendar.movingShadow.parentNode.style.display='';var $U=$T.clientWidth/$T.rows[0].cells.length;var $v=Math.floor(($b.coords.x-45)/$U);if($v<$T.rows[0].cells.length&&$v>=0&&DayPilotCalendar.movingShadow.column!==$v){DayPilotCalendar.movingShadow.column=$v;DayPilotCalendar.moveShadow($T.rows[0].cells[$v]);};if(!$b.allowEventOverlap){$b.overlap=$b.isOverlapping($v);if($b.overlap){document.body.style.cursor='not-allowed';}else{document.body.style.cursor='move';}}};if(DayPilotCalendar.drag){if(DayPilotCalendar.gShadow){document.body.removeChild(DayPilotCalendar.gShadow);};DayPilotCalendar.gShadow=null;if(!DayPilotCalendar.movingShadow&&$b.coords){DayPilotCalendar.movingShadow=$b.createShadow(DayPilotCalendar.drag.duration,DayPilotCalendar.drag.shadowType);DayPilotCalendar.moving=new DayPilot.Event(DayPilotCalendar.drag.id,DayPilotCalendar.drag.duration,DayPilotCalendar.drag.text);DayPilotCalendar.moving.root=$b;DayPilotCalendar.moving.external=true;};ev.cancelBubble=true;}};$b.nav.scrollable.style.display='';};this.getColor=function(x,y){if(this.colors){return this.colors[y+this.autoHiddenRows()][x];}else{var $f={};$f.resource=this.columnsBottom[x].Value;$f.start=new DayPilot.Date(this.columnsBottom[x].Start).addTime(y*this.cellDuration).addHours(this.autoHiddenHours());$f.backColor=this.isBusiness($f)?this.cellBackColor:this.cellBackColorNonBusiness;var $1N=this.beforeCellRender($f);if($1N){return $1N.backColor;}else{return this.cellBackColor;}}};this.isBusiness=function($f){if($f.start.dayOfWeek()===0||$f.start.dayOfWeek()===6){return false;};if(this.cellDuration<720){if($f.start.getHours()<this.businessBeginsHour||$f.start.getHours()>=this.businessEndsHour){return false;}else{return true;}};return true;};this.beforeCellRender=function($f){return $f;};this.disposeHeader=function(){var $1r=this.nav.header;if($1r&&$1r.rows){for(var y=0;y<$1r.rows.length;y++){var r=$1r.rows[y];for(var x=0;x<r.cells.length;x++){var c=r.cells[x];c.onclick=null;c.onmousemove=null;c.onmouseout=null;}}};if(!this.fasterDispose)DayPilot.pu($1r);};this.drawHeaderRow=function($0U,$1F){var r=($1F)?this.nav.header.insertRow(-1):this.nav.header.rows[$0U-1];var $0E=this.columns.getColumns($0U);var $1O=$0E.length;for(var i=0;i<$1O;i++){var $y=$0E[i];var $1P=$y.getChildren?true:false;var $f=($1F)?r.insertCell(-1):r.cells[i];$f.data=$y;if($0U===$b.headerLevels){$f.style.width=(100.0/$0E.length)+"%";}else{var $1Q=1;if($1P){$1Q=$y.getChildrenCount($b.headerLevels-$0U+1);};$f.colSpan=$1Q;};if($1P){$f.onclick=this.headerClickDispatch;$f.onmousemove=this.headerMouseMove;$f.onmouseout=this.headerMouseOut;if($y.ToolTip){$f.title=$y.ToolTip;}};$f.style.overflow='hidden';$f.style.padding='0px';$f.style.border='0px none';$f.style.height=(this.headerHeight)+"px";var $06=($1F)?document.createElement("div"):$f.firstChild;if($1F){$06.unselectable='on';$06.style.MozUserSelect='none';$06.style.backgroundColor=$y.BackColor;$06.className=$b.applyCssClass('colheader');$06.style.cursor='default';$06.style.position='relative';$06.style.fontFamily=this.headerFontFamily;$06.style.fontSize=this.headerFontSize;$06.style.color=this.headerFontColor;if($0U!==1){$06.style.borderTop='1px solid '+this.borderColor;};if($b.rtl){if(i===$1O-1){$06.style.borderLeft="1px solid "+$y.BackColor;}else{$06.style.borderLeft="1px solid "+this.borderColor;}}else{if(i===$1O-1){$a();}else{$06.style.borderRight="1px solid "+this.borderColor;}};$06.style.height=this.headerHeight+"px";var $r=document.createElement("div");$r.style.position='absolute';$r.style.left='0px';$r.style.width='100%';$r.style.padding="2px";$06.style.textAlign='center';$r.unselectable='on';if(this.headerClickHandling!=="Disabled"){$r.style.cursor='pointer';};$06.appendChild($r);$f.appendChild($06);};if($1P){var $r=$06.firstChild;$r.innerHTML=$y.InnerHTML;}}};this.widthUnit=function(){if(this.width&&this.width.indexOf("px")!=-1){return "Pixel";};return "Percentage";};this.drawHeader=function(){if(!this.showHeader){return;};var $14=this.nav.header;var $1F=true;var $0E=this.columns.getColumns($b.headerLevels,true);var $1O=$0E.length;if(this.headerCreated&&$14&&$14.rows&&$14.rows.length>0){$1F=$14.rows[$14.rows.length-1].cells.length!==$1O;}while(this.headerCreated&&$14&&$14.rows&&$14.rows.length>0&&$1F){if(!this.fasterDispose)DayPilot.pu($14.rows[0]);$14.deleteRow(0);};this.headerCreated=true;if(!$1F){var $1y=$b.nav.corner;$1y.style.backgroundColor=$b.cornerBackColor;if(!this.fasterDispose)DayPilot.pu($1y.firstChild);$1y.firstChild.innerHTML=$b.cornerHTML?$b.cornerHTML:'';};for(var i=0;i<$b.headerLevels;i++){this.drawHeaderRow(i+1,$1F);};if(!this.showAllDayEvents){return;};var r=($1F)?$14.insertRow(-1):$14.rows[$b.headerLevels];var w=100/$1O;for(var i=0;i<$1O;i++){var $y=$0E[i];var $f=($1F)?r.insertCell(-1):r.cells[i];$f.data=$y;$f.style.width=w+"%";$f.style.padding='0px';$f.style.border='0px none';$f.style.overflow='hidden';$f.style.lineHeight='1.2';var $06=($1F)?document.createElement("div"):$f.firstChild;if($1F){$06.unselectable='on';$06.style.MozUserSelect='none';$06.style.display='block';$06.style.textAlign='center';$06.style.backgroundColor=$y.BackColor;$06.style.cursor='default';$06.style.borderTop='1px solid '+this.borderColor;$06.className=this.applyCssClass("alldayheader");if($b.rtl){if(i===$1O-1){$06.style.borderLeft="1px solid "+$y.BackColor;}else{$06.style.borderLeft="1px solid "+this.borderColor;}}else{if(i===$1O-1){$a();}else{$06.style.borderRight="1px solid "+this.borderColor;}};$06.style.overflow='hidden';var $r=document.createElement("div");$r.style.paddingLeft="2px";$r.style.paddingRight="2px";$r.style.paddingTop="2px";$r.unselectable='on';$06.appendChild($r);$f.appendChild($06);};$06.style.height=this.allDayHeaderHeight+"px";}};this.loadingStart=function(){if(this.loadingLabelVisible){this.nav.loading.innerHTML=this.loadingLabelText;this.nav.loading.style.top=(this.totalHeaderHeight()+5)+"px";this.nav.loading.style.display='';}};this.loadingStop=function($1R){if(this.callbackTimeout){window.clearTimeout(this.callbackTimeout);};this.nav.loading.style.display='none';};this.enableScrolling=function(){var $1S=this.nav.scroll;if(!this.initScrollPos)return;$1S.root=this;$1S.onscroll=this.scroll;if($1S.scrollTop===0){$1S.scrollTop=this.initScrollPos;}else{this.scroll();}};this.callbackError=function($H,$I){alert("Error!\r\nResult: "+$H+"\r\nContext:"+$I);};this.fixScrollHeader=function(){var w=DayPilot.sw(this.nav.scroll);var d=this.nav.cornerRight;if(d&&w>0){d.style.width=(w-1)+'px';}};this.startAutoRefresh=function($1T){if($1T){this.autoRefreshEnabled=true;};if(!this.autoRefreshEnabled){return;};if(this.autoRefreshCount>=this.autoRefreshMaxCount){return;};this.stopAutoRefresh();var $1U=this.autoRefreshInterval;if(!$1U||$1U<10){throw "The minimum autoRefreshInterval is 10 seconds";};this.autoRefreshTimeout=window.setTimeout(function(){$b.doRefresh();},this.autoRefreshInterval*1000);};this.stopAutoRefresh=function(){if(this.autoRefreshTimeout){window.clearTimeout(this.autoRefreshTimeout);}};this.doRefresh=function(){if(!DayPilotCalendar.resizing&&!DayPilotCalendar.moving&&!DayPilotCalendar.drag&&!DayPilotCalendar.selecting){this.autoRefreshCount++;this.commandCallBack(this.autoRefreshCommand);};if(this.autoRefreshCount<this.autoRefreshMaxCount){this.autoRefreshTimeout=window.setTimeout(function(){$b.doRefresh();},this.autoRefreshInterval*1000);}};this.resize=function(){if($b.heightSpec==="Parent100Pct"){$b.setHeight(parseInt($b.nav.top.clientHeight,10));};$b.updateHeight();$b.updateScrollLabels();};this.registerGlobalHandlers=function(){if(!DayPilotCalendar.globalHandlers){DayPilotCalendar.globalHandlers=true;DayPilot.re(document,'mousemove',DayPilotCalendar.gMouseMove);DayPilot.re(document,'mouseup',DayPilotCalendar.gMouseUp);DayPilot.re(window,'unload',DayPilotCalendar.gUnload);};DayPilot.re(window,'resize',this.resize);};this.loadEvents=function($1V){if(!$1V){$1V=this.events;};this.allDay={};this.allDay.events=[];this.allDay.lines=[];var length=$1V.length;var $q=this.duration(true);this.cache.pixels={};var $1W=[];this.scrollLabels=[];this.minStart=10000;this.maxEnd=0;this.debug("minStart reset");if(!$1V){return;};for(var i=0;i<length;i++){var e=$1V[i];e.Start=new DayPilot.Date(e.Start);e.End=new DayPilot.Date(e.End);};var $1X=this.viewType==='Resources';var $1Y=this.startDate;var $1Z=this.startDate.addDays(this.days);for(var i=0;i<this.columnsBottom.length;i++){var scroll={};scroll.minEnd=1000000;scroll.maxStart=-1;this.scrollLabels.push(scroll);var $1l=this.columnsBottom[i];$1l.events=[];$1l.lines=[];$1l.blocks=[];var $0j=new DayPilot.Date($1l.Start).addHours(this.visibleStart(true));var $20=$0j.getTime();var $21=$0j.addTime($q);var $22=$21.getTime();if($1X){$1Y=$0j.getDatePart();$1Z=$21.getDatePart();};for(var j=0;j<length;j++){if($1W[j]){continue;};var e=$1V[j];var $0d=e.Start;var end=e.End;var $23=$0d.getTime();var $24=end.getTime();if($24<$23){continue;};if(e.AllDay){var $25=false;if($b.allDayEnd==='Date'){$25=!($24<$1Y.getTime()||$23>=$1Z.getTime());}else{$25=!($24<=$1Y.getTime()||$23>=$1Z.getTime());};if($1X){$25=$25&&(e.Resource===$1l.Value||$1l.Value==="*");};if($25){var ep={};ep.Text=e.Text;ep.Value=e.Value;ep.ToolTip=e.ToolTip?e.ToolTip:e.Text;ep.Start=$0d;ep.End=end;ep.DayIndex=i;ep.AllDay=e.AllDay;ep.PartStart=$1Y.getTime()<$23?ep.Start:$1Y;ep.PartEnd=$1Z.getTime()>$24?ep.End:$1Z;ep.BackgroundColor=e.BackColor?e.BackColor:this.eventBackColor;ep.InnerHTML=e.InnerHTML?e.InnerHTML:e.Text;ep.Tag=e.Tag;ep.BackgroundImage=e.BackgroundImage;ep.BackgroundRepeat=e.BackgroundRepeat;ep.StaticBubbleHTML=e.StaticBubbleHTML;ep.Recurrent=e.Recurrent;ep.RecurrentMasterId=e.RecurrentMasterId;ep.RightClickEnabled=this.rightClickHandling!=='Disabled'&&!e.RightClickDisabled;ep.ClickEnabled=this.eventClickHandling!=='Disabled'&&!e.ClickDisabled;ep.DoubleClickEnabled=this.eventDoubleClickHandling!=='Disabled'&&!e.DoubleClickDisabled;ep.ContextMenu=e.ContextMenu;ep.CssClass=e.CssClass;ep.ColStart=DayPilot.Date.daysDiff(this.startDate.d,ep.PartStart.d);ep.ColWidth=DayPilot.Date.daysSpan(ep.PartStart.d,ep.PartEnd.d)+1;if($1X){ep.ColStart=i;ep.ColWidth=1;};this.allDay.events.push(ep);$1W[j]=true;};continue;};var $25=false;if($1X){$25=($1l.Value===e.Resource)&&!($24<=$20||$23>=$22);}else{$25=!($24<=$20||$23>=$22);};if($25){var ep={};ep.Text=e.Text;ep.Value=e.Value;ep.ToolTip=e.ToolTip?e.ToolTip:e.Text;ep.Start=$0d;ep.End=end;ep.DayIndex=i;ep.AllDay=e.AllDay;ep.PartStart=$20<$23?ep.Start:$0j;ep.PartEnd=$22>$24?ep.End:$21;ep.BackgroundColor=e.BackColor?e.BackColor:this.eventBackColor;ep.InnerHTML=e.InnerHTML?e.InnerHTML:e.Text;ep.BarColor=e.BarColor?e.BarColor:this.durationBarColor;ep.Tag=e.Tag;ep.BackgroundImage=e.BackgroundImage;ep.BackgroundRepeat=e.BackgroundRepeat;ep.StaticBubbleHTML=e.StaticBubbleHTML;ep.Sort=e.Sort;ep.DurationBarImageUrl=e.DurationBarImageUrl;ep.Header=e.Header;ep.BorderColor=e.BorderColor?e.BorderColor:this.eventBorderColor;ep.FontColor=e.FontColor?e.FontColor:this.eventFontColor;ep.Recurrent=e.Recurrent;ep.RecurrentMasterId=e.RecurrentMasterId;ep.MoveEnabled=this.eventMoveHandling!=='Disabled'&&!e.MoveDisabled;ep.ResizeEnabled=this.eventResizeHandling!=='Disabled'&&!e.ResizeDisabled;ep.RightClickEnabled=this.rightClickHandling!=='Disabled'&&!e.RightClickDisabled;ep.ClickEnabled=this.eventClickHandling!=='Disabled'&&!e.ClickDisabled;ep.DoubleClickEnabled=this.eventDoubleClickHandling!=='Disabled'&&!e.DoubleClickDisabled;ep.DeleteEnabled=this.eventDeleteHandling!=='Disabled'&&!e.DeleteDisabled;ep.ContextMenu=e.ContextMenu;ep.CssClass=e.CssClass;var $26=this.getPixels(ep.PartStart,$1l.Start);var $27=this.getPixels(ep.PartEnd,$1l.Start);var top=$26.top;var $0Q=$27.top;if(top===$0Q&&($26.cut||$27.cut)){continue;};ep.Box=this.useBox($24-$23);if(ep.Box){var $28=$27.boxBottom;ep.Top=Math.floor(top/this.cellHeight)*this.cellHeight+1;ep.Height=Math.max(Math.ceil($28/this.cellHeight)*this.cellHeight-ep.Top,this.cellHeight-1)+1;ep.BarTop=Math.max(top-ep.Top-1,0);ep.BarHeight=Math.max($0Q-top-2,1);}else{ep.Top=top+1;ep.Height=Math.max($0Q-top,0);ep.BarTop=0;ep.BarHeight=Math.max($0Q-top-2,1);};var $0d=ep.Top;var end=ep.Top+ep.Height;if($0d>scroll.maxStart){scroll.maxStart=$0d;};if(end<scroll.minEnd){scroll.minEnd=end;};if($0d<this.minStart){this.debug("new minStart: "+$0d+" - "+ep.Start+" "+ep.Text);this.minStart=$0d;};if(end>this.maxEnd){this.maxEnd=end;};$1l.events.push(ep);if(ep.PartStart.getTime()===$23&&ep.PartEnd.getTime()===$24){$1W[j]=true;}}}};for(var i=0;i<this.columnsBottom.length;i++){var $1l=this.columnsBottom[i];$1l.events.sort(this.eventComparer);for(var j=0;j<$1l.events.length;j++){var e=$1l.events[j];$1l.putIntoBlock(e);};for(var j=0;j<$1l.blocks.length;j++){var $10=$1l.blocks[j];$10.events.sort(this.eventComparerCustom);for(var k=0;k<$10.events.length;k++){var e=$10.events[k];$10.putIntoLine(e);}}};this.allDay.events.sort(this.eventComparerCustom);this.allDay.putIntoLine=function(ep){var $12=this;for(var i=0;i<this.lines.length;i++){var $13=this.lines[i];if($13.isFree(ep.ColStart,ep.ColWidth)){$13.push(ep);return i;}};var $13=[];$13.isFree=function($0d,$11){var end=$0d+$11-1;var $W=this.length;for(var i=0;i<$W;i++){var e=this[i];if(!(end<e.ColStart||$0d>e.ColStart+e.ColWidth-1)){return false;}};return true;};$13.push(ep);this.lines.push($13);return this.lines.length-1;};for(var i=0;i<this.allDay.events.length;i++){var e=this.allDay.events[i];this.allDay.putIntoLine(e);};var $29=Math.max(this.allDay.lines.length,1);this.allDayHeaderHeight=$29*(this.allDayEventHeight+2)+2;};this.eventComparer=function(a,b){if(!a||!b||!a.Start||!b.Start){return 0;};var $2a=a.Start.getTime()-b.Start.getTime();if($2a!==0){return $2a;};var $2b=b.End.getTime()-a.End.getTime();return $2b;};this.eventComparerCustom=function(a,b){if(!a||!b){return 0;};if(!a.Sort||!b.Sort||a.Sort.length===0||b.Sort.length===0){return $b.eventComparer(a,b);};var $H=0;var i=0;while($H===0&&a.Sort[i]&&b.Sort[i]){if(a.Sort[i]===b.Sort[i]){$H=0;}else{$H=$b.stringComparer(a.Sort[i],b.Sort[i],$b.sortDirections[i]);};i++;};return $H;};this.stringComparer=function(a,b,$2c){var $2d=($2c!=="desc");var $2e=$2d?-1:1;var $2f=-$2e;if(!a&&!b){return 0;};if(!b){return $2f;};if(!a){return $2e;};var ar=[];ar[0]=a;ar[1]=b;ar.sort();return a===ar[0]?$2e:$2f;};this.debug=function($1R,$2g){if(!this.debuggingEnabled){return;};if(!$b.debugMessages){$b.debugMessages=[];};$b.debugMessages.push($1R);if(typeof $2h!=='undefined'){$2h.log($1R);}};this.useBox=function($2i){if(this.useEventBoxes==='Always'){return true;};if(this.useEventBoxes==='Never'){return false;};return $2i<this.cellDuration*60*1000;};this.getPixels=function($0r,$0d){if(!$0d)$0d=this.startDate;var $23=$0d.getTime();var $2j=$0r.getTime();var $2k=this.cache.pixels[$2j+"_"+$23];if($2k){return $2k;};$23=$0d.addHours(this.visibleStart(true)).getTime();var $2l=this.cellDuration*60*1000;var $2m=$2j-$23;var $2n=$2m%$2l;var $2o=$2m-$2n;var $2p=$2o+$2l;if($2n===0){$2p=$2o;};var $H={};$H.cut=false;$H.top=this.ticksToPixels($2m);$H.boxTop=this.ticksToPixels($2o);$H.boxBottom=this.ticksToPixels($2p);this.cache.pixels[$2j+"_"+$23]=$H;return $H;};this.ticksToPixels=function($2j){return Math.floor((this.cellHeight*$2j)/(1000*60*this.cellDuration));};this.prepareVariables=function(){this.startDate=new DayPilot.Date(this.startDate);this.allDayHeaderHeight=this.allDayEventHeight+4;};this.updateHeaderHeight=function(){if(this.nav.corner){this.nav.corner.style.height=this.totalHeaderHeight()+"px";};if(this.showAllDayEvents){var $2q=this.nav.header.rows[this.nav.header.rows.length-1];for(var i=0;i<$2q.cells.length;i++){var $v=$2q.cells[i];$v.firstChild.style.height=this.allDayHeaderHeight+"px";}}};this.updateHeight=function(){if(this.nav.scroll){this.nav.scroll.style.height=this.getScrollableHeight()+"px";this.scrollHeight=$b.nav.scroll.clientHeight;}};this.setHeight=function($1h){if(this.heightSpec!=="Parent100Pct"){this.heightSpec="Fixed";};this.height=$1h-(this.totalHeaderHeight()+3);this.updateHeight();};this.loadFromServer=function(){return(typeof this.events==='undefined')||!this.events;};this.initShort=function(){this.prepareVariables();this.prepareColumns();this.drawTop();this.drawHeader();this.drawMain();this.fixScrollHeader();this.enableScrolling();this.registerGlobalHandlers();DayPilotCalendar.register(this);this.startAutoRefresh();this.callBack2('Init');};this.Init=function(){var $2r=this.loadFromServer();if($2r){this.initShort();return;};this.prepareVariables();this.prepareColumns();if(this.events){this.loadEvents();};this.drawTop();this.drawHeader();this.drawMain();this.fixScrollHeader();this.enableScrolling();this.registerGlobalHandlers();DayPilotCalendar.register(this);if(this.events){this.updateHeaderHeight();this.drawEvents();this.drawEventsAllDay();};this.resize();if(this.messageHTML){this.message(this.messageHTML,5000);};this.afterRender(null,false);this.startAutoRefresh();};};DayPilotCalendar.Cell=function($0d,end,$v){this.start=$0d;this.end=end;this.column=function(){};};DayPilotCalendar.Column=function($2s,name,$0r){this.value=$2s;this.name=name;this.date=new DayPilot.Date($0r);};DayPilotCalendar.Event=function($e,$b){$e.event=this;this.div=$e;this.root=$b;this.value=function(){return $e.data.Value;};this.id=function(){return $e.data.Value;};this.text=function(){return $e.data.Text;};this.start=function(){return $e.data.Start;};this.end=function(){return $e.data.End;};this.partStart=function(){return $e.data.PartStart;};this.partEnd=function(){return $e.data.PartEnd;};this.recurrent=function(){return $e.data.Recurrent;};this.recurrentMasterId=function(){return $e.data.RecurrentMasterId;};this.column=function(){return this.resource();};this.resource=function(){return this.root.columnsBottom[$e.data.DayIndex].Value;};this.innerHTML=function(){var c=$e.getElementsByTagName("DIV");return c[c.length-1].innerHTML;};this.staticBubbleHTML=function(){return $e.data.StaticBubbleHTML;};this.tag=function($2t){var $2u=$e.data.Tag;if(!$2u){return null;};if(!$2t){return $e.data.Tag;};var $2v=$b.tagFields;var $2w=-1;for(var i=0;i<$2v.length;i++){if($2t===$2v[i])$2w=i;};if($2w===-1){throw "Field name not found.";};return $2u[$2w];};this.movingAllowed=function(){return $e.data.MoveEnabled&&$b.eventMoveHandling!=="Disabled";};this.resizingAllowed=function(){return $e.data.ResizeEnabled&&$b.eventResizeHandling!=="Disabled";};this.clickingAllowed=function(){return $e.data.ClickEnabled&&$b.eventClickHandling!=="Disabled";};this.rightClickingAllowed=function(){return $e.data.RightClickEnabled&&$b.rightClickHandling!=="Disabled";};this.isSelected=function(){return $b.selectedEvent()===this;};this.isAllDay=function(){return $e.data.AllDay;};this.toJSON=function($M){var $2x={};$2x.value=this.value();$2x.text=this.text();$2x.start=this.start();$2x.end=this.end();$2x.resource=this.resource();$2x.isAllDay=this.isAllDay()?true:false;$2x.isSelected=this.isSelected();$2x.recurrentMasterId=this.recurrentMasterId();$2x.tag={};if($b.tagFields){var $2v=$b.tagFields;for(var i=0;i<$2v.length;i++){$2x.tag[$2v[i]]=this.tag($2v[i]);}};return $2x;};if($b.nav.select.value===this.value()){$b.divSelectOne($e);};$e.onmousemove=function(ev){var $2y=5;var $2z=Math.max($b.durationBarWidth,10);var w=5;var $14=($b.moveBy==='Top');if(typeof(DayPilotCalendar)==='undefined'){return;};var $1M=DayPilot.mo2(this,ev);if(!$1M){return;};if(DayPilotCalendar.resizing||DayPilotCalendar.moving){return;};var $2A=this.isFirst;var $2B=this.isLast;if(!$14&&$1M.x<=$2z&&$e.event.movingAllowed()){if($2A){this.style.cursor='move';}else{this.style.cursor='not-allowed';}}else if(!$14&&$1M.y<=$2y&&$e.event.resizingAllowed()){if($2A){this.style.cursor="n-resize";this.dpBorder='top';}else{this.style.cursor='not-allowed';}}else if($14&&$1M.y<=$2z&&$e.event.movingAllowed()){this.style.cursor="move";}else if(this.offsetHeight-$1M.y<=$2y&&$e.event.resizingAllowed()){if($2B){this.style.cursor="s-resize";this.dpBorder='bottom';}else{this.style.cursor='not-allowed';}}else if(!DayPilotCalendar.resizing&&!DayPilotCalendar.moving){if($e.event.clickingAllowed())this.style.cursor='pointer';else this.style.cursor='default';};if(typeof(DayPilotBubble)!=='undefined'&&$b.bubble&&$b.eventHoverHandling!=='Disabled'){if(this.style.cursor==='default'||this.style.cursor==='pointer'){$b.bubble.showEvent($b.uniqueID,this.event);}else{$a();}}};$e.onmousedown=function(ev){ev=ev||window.event;var $0y=ev.which||ev.button;if(typeof(DayPilotBubble)!=='undefined'){DayPilotBubble.hideActive();};if((this.style.cursor==='n-resize'||this.style.cursor==='s-resize')&&$0y===1){DayPilotCalendar.resizing=this;DayPilotCalendar.originalMouse=DayPilot.mc(ev);DayPilotCalendar.originalHeight=this.offsetHeight;DayPilotCalendar.originalTop=this.offsetTop;DayPilotCalendar.resizingShadow=DayPilotCalendar.createShadow(this,false,$b.shadow);this.onclickSave=this.onclick;this.onclick=null;}else if(this.style.cursor==='move'&&$0y===1){DayPilotCalendar.moving=this.event;DayPilotCalendar.moving.oldColumn=$b.columnsBottom[this.data.DayIndex].Value;DayPilotCalendar.height=this.data.Height;DayPilotCalendar.originalMouse=DayPilot.mc(ev);DayPilotCalendar.originalTop=this.offsetTop;DayPilotCalendar.originalLeft=this.offsetLeft;var $1M=DayPilot.mo(null,ev);if($1M){DayPilotCalendar.moveOffsetY=$1M.y;}else{DayPilotCalendar.moveOffsetY=0;};DayPilotCalendar.movingShadow=DayPilotCalendar.createShadow(this,!$b.ie,$b.shadow);DayPilotCalendar.movingShadow.style.width=(DayPilotCalendar.movingShadow.parentNode.offsetWidth+1)+'px';document.body.style.cursor='move';this.onclickSave=this.onclick;this.onclick=null;}else{if(this.onclickSave){this.onclick=this.onclickSave;this.onclickSave=null;}};return false;};};DayPilot.CalendarVisible.dragStart=DayPilotCalendar.dragStart;DayPilot.CalendarVisible.Calendar=DayPilotCalendar.Calendar;DayPilot.Calendar=DayPilotCalendar.Calendar;})();


