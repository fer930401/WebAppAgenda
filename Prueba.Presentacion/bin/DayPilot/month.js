
if(typeof DayPilot==='undefined'){var DayPilot={};};if(typeof DayPilotMonth==='undefined'){var DayPilotMonth=DayPilot.MonthVisible={};};(function(){var $a=function(){};if(typeof DayPilot.Month!=='undefined'){return;};var DayPilotMonth={};DayPilotMonth.Month=function($b){var $c=document.getElementById($b);var $d=this;this.id=$b;this.startDate=new DayPilot.Date();this.width='100%';this.cellHeight=100;this.autoRefreshCommand='refresh';this.autoRefreshEnabled=false;this.autoRefreshInterval=60;this.autoRefreshMaxCount=20;this.eventFontColor="#000000";this.eventFontFamily="Tahoma";this.eventFontSize="11px";this.headerBackColor='#ECE9D8';this.headerFontColor='#000000';this.headerFontFamily="Tahoma";this.headerFontSize="10pt";this.headerHeight=20;this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.weekStarts=1;this.innerBorderColor='#cccccc';this.borderColor='black';this.eventHeight=16;this.cellHeaderHeight=16;this.numberFormat="0.00";this.clientState={};this.afterRender=function(){};this.backColor='#FFFFD5';this.nonBusinessBackColor='#FFF4BC';this.cellHeaderBackColor='';this.cellHeaderFontColor='#000000';this.cellHeaderFontFamily='Tahoma';this.cellHeaderFontSize='10pt';this.eventBackColor='White';this.eventBorderColor='Black';this.eventCorners="Regular";this.eventFontColor='#000000';this.eventFontFamily='Tahoma';this.eventFontSize='11px';this.eventHeight=16;this.cellWidth=14.285;this.lineSpace=1;this.eventTextLayer='Top';this.eventStartTime=true;this.eventEndTime=true;this.eventTextAlignment='Center';this.eventTextLeftIndent=20;this.showWeekend=true;this.cellMode=false;this.shadowType="Fill";this.eventTimeFontColor='gray';this.eventTimeFontFamily='Tahoma';this.eventTimeFontSize='8pt';this.viewType='Month';this.weeks=1;this.eventMoveHandling='Disabled';this.eventResizeHandling='Disabled';this.eventRightClickHandling='ContextMenu';this.timeRangeSelectedHandling='Diabled';this.timeRangeDoubleClickHandling='Disabled';this.onTimeRangeDoubleClick=function(){};this.backendUrl=null;this.cellEvents=[];this.eventDivs=[];this.nav={};this.autoRefreshCount=0;this.updateView=function($e,$f){var $e=eval("("+$e+")");if($e.UpdateType==="None"){return;};if($e.VsUpdate){var $g=document.createElement("input");$g.type='hidden';$g.name=$d.id+"_vsupdate";$g.id=$g.name;$g.value=$e.VsUpdate;$d.vsph.innerHTML='';$d.vsph.appendChild($g);};$d.events=$e.Events;if($e.UpdateType==="Full"){$d.cellProperties=$e.CellProperties;$d.headerProperties=$e.HeaderProperties;$d.startDate=$e.StartDate;$d.showWeekend=$e.ShowWeekend?$e.ShowWeekend:$d.showWeekend;$d.headerBackColor=$e.HeaderBackColor?$e.HeaderBackColor:$d.headerBackColor;$d.backColor=$e.BackColor?$e.BackColor:$d.backColor;$d.nonBusinessBackColor=$e.NonBusinessBackColor?$e.NonBusinessBackColor:$d.nonBusinessBackColor;$d.locale=$e.Locale?$e.Locale:$d.locale;$d.timeFormat=$e.TimeFormat?$e.TimeFormat:$d.timeFormat;if(typeof $e.WeekStarts!=='undefined'){$d.weekStarts=$e.WeekStarts;};$d.hashes=$e.Hashes;};$d.clearEvents();$d.prepareRows();$d.prepareEvents();if($e.UpdateType==="Full"){$d.clearTable();$d.drawTable();};$d.updateHeight();$d.drawEvents();$d.afterRender($e.CallBackData,true);$d.startAutoRefresh();if($e.Message){$d.message($e.Message,5000);}};this.lineHeight=function(){return this.eventHeight+this.lineSpace;};this.applyCssClass=function($h){if(this.cssClassPrefix){return this.cssClassPrefix+$h;}else{return "";}};this.rounded=function(){return this.eventCorners==="Rounded";};this.prepareEvents=function(){if(this.cellMode){this.prepareEventsCells();}else{this.prepareEventsRows();}};this.prepareEventsRows=function(){for(var x=0;x<this.events.length;x++){var e=this.events[x];e.Start=new DayPilot.Date(e.Start).d;e.End=new DayPilot.Date(e.End).d;if(e.Start.getTime()>e.End.getTime()){continue;};for(var i=0;i<this.rows.length;i++){var $i=this.rows[i];if($i.belongsHere(e)){$i.events.push(e);}}};for(var ri=0;ri<this.rows.length;ri++){var $i=this.rows[ri];$i.events.sort(this.eventComparerCustom);for(var ei=0;ei<this.rows[ri].events.length;ei++){var ev=$i.events[ei];var $j=$i.getStartColumn(ev);var $k=$i.getWidth(ev);var $l=$i.putIntoLine(ev,$j,$k,ri);}}};this.prepareEventsCells=function(){this.cellEvents=[];for(var x=0;x<this.getColCount();x++){this.cellEvents[x]=[];for(var y=0;y<this.rows.length;y++){var $m={};var d=DayPilot.Date.addDays(this.firstDate,y*7+x);$m.start=d;$m.end=DayPilot.Date.addDays(d,1);$m.events=[];this.cellEvents[x][y]=$m;}};for(var i=0;i<this.events.length;i++){var e=this.events[i];e.Start=new DayPilot.Date(e.Start);e.End=new DayPilot.Date(e.Start);if(e.Start.getTime()>e.End.getTime()){continue;};for(var x=0;x<this.getColCount();x++){for(var y=0;y<this.rows.length;y++){var $m=this.cellEvents[x][y];if(e.Start.getTime()>=$m.start.getTime()&&e.Start.getTime()<$m.end.getTime()){$m.events.push(e);}}}};for(var x=0;x<this.getColCount();x++){for(var y=0;y<this.rows.length;y++){var $m=this.cellEvents[x][y];$m.events.sort(this.eventComparerCustom);}}};this.clearEvents=function(){for(var i=0;i<this.eventDivs.length;i++){this.eventDivs[i].parentNode.removeChild(this.eventDivs[i]);};this.eventDivs=[];};this.drawEvents=function(){if(this.cellMode){this.drawEventsCells();}else{this.drawEventsRows();}};this.drawEventsCells=function(){this.eventDivs=[];for(var x=0;x<this.getColCount();x++){for(var y=0;y<this.rows.length;y++){var $m=this.cellEvents[x][y];var $n=this.cells[x][y];for(var i=0;i<$m.events.length;i++){var $o={};$o.event=$m.events[i];$o.colStart=x;$o.colWidth=1;$o.row=y;$o.line=i;$o.startsHere=true;$o.endsHere=true;this.drawEvent($o);}}}};this.drawEventsRows=function(){this.eventDivs=[];for(var ri=0;ri<this.rows.length;ri++){var $i=this.rows[ri];for(var li=0;li<$i.lines.length;li++){var $l=$i.lines[li];for(var pi=0;pi<$l.length;pi++){this.drawEvent($l[pi]);}}}};this.eventComparer=function(a,b){if(!a||!b||!a.Start||!b.Start){return 0;};var $p=a.Start.getTime()-b.Start.getTime();if($p!==0){return $p;};var $q=b.End.getTime()-a.End.getTime();return $q;};this.eventComparerCustom=function(a,b){if(!a||!b){return 0;};if(!a.Sort||!b.Sort||a.Sort.length===0||b.Sort.length===0){return $d.eventComparer(a,b);};var $e=0;var i=0;while($e===0&&a.Sort[i]&&b.Sort[i]){if(a.Sort[i]===b.Sort[i]){$e=0;}else{$e=$d.stringComparer(a.Sort[i],b.Sort[i],$d.sortDirections[i]);};i++;};return $e;};this.stringComparer=function(a,b,$r){var $s=($r!=="desc");var $t=$s?-1:1;var $u=-$t;if(a===null&&b===null){return 0;};if(b===null){return $u;};if(a===null){return $t;};var ar=[];ar[0]=a;ar[1]=b;ar.sort();return a===ar[0]?$t:$u;};this.drawShadow=function(x,y,$l,$v,$w,e){if(!$w){$w=0;};var $x=$v;this.shadow=[];this.shadow.start={x:x,y:y};this.shadow.width=$v;var $y=y*7+x-$w;if($y<0){$x+=$y;x=0;y=0;};var $z=$w;while($z>=7){y--;$z-=7;};if($z>x){var $A=7-this.getColCount();if($z>(x+$A)){y--;x=x+7-$z;}else{$x=$x-$z+x;x=0;}}else{x-=$z;};if(y<0){y=0;x=0;};if(DayPilotMonth.resizingEvent){this.relative.style.cursor='w-resize';}else if(DayPilotMonth.movingEvent){this.relative.style.cursor='move';}while($x>0&&y<this.rows.length){var $B=Math.min(this.getColCount()-x,$x);var $i=this.rows[y];var $C=document.createElement("div");$C.unselectable='on';$C.style.position='absolute';$C.style.left=(this.getCellWidth()*x)+'%';$C.style.width=(this.getCellWidth()*$B)+'%';$C.style.top=(this.getRowTop(y)+1)+'px';$C.style.height=(this.eventHeight)+'px';var $D=document.createElement("div");$D.style.marginLeft='1px';$D.style.height=($i.getHeight()-5)+'px';$D.style.border='2px dotted #666666';if(this.shadowType==='Fill'){$D.style.backgroundColor="#aaaaaa";$D.style.opacity=0.5;$D.style.filter="alpha(opacity=50)";$D.style.border='2px solid #aaaaaa';if(e&&e.eventPart&&e.eventPart.event){$D.style.overflow='hidden';$D.style.fontSize=this.eventFontSize;$D.style.fontFamily=this.eventFontFamily;$D.style.color=this.eventFontColor;$D.innerHTML=e.eventPart.event.InnerHTML?e.eventPart.event.InnerHTML:e.eventPart.event.Text;}};$C.appendChild($D);this.relative.appendChild($C);this.shadow.push($C);$x-=($B+7-this.getColCount());x=0;y++;}};this.clearShadow=function(){if(this.shadow){for(var i=0;i<this.shadow.length;i++){this.relative.removeChild(this.shadow[i]);};this.shadow=null;this.relative.style.cursor='';}};this.getEventTop=function($i,$l){var top=this.headerHeight;for(var i=0;i<$i;i++){top+=this.rows[i].getHeight();};top+=this.cellHeaderHeight;top+=$l*this.lineHeight();return top;};this.getDateFromCell=function(x,y){return DayPilot.Date.addDays(this.firstDate,y*7+x);};this.drawEvent=function($o,$E){var $E=this.cellMode;var ev=$o.event;var $i=$o.row;var $l=$o.line;var $j=$o.colStart;var $k=$o.colWidth;var $F=$E?0:this.getCellWidth()*($j);var $v=$E?100:this.getCellWidth()*($k);var top=$E?$l*this.lineHeight():this.getEventTop($i,$l);var e=document.createElement("div");e.unselectable='on';e.style.height=this.eventHeight+'px';e.style.fontFamily=this.eventFontFamily;if($E){e.style.marginRight="2px";e.style.marginBottom="2px";}else{e.style.width=$v+'%';e.style.position='absolute';e.style.left=$F+'%';e.style.top=top+'px';};if(this.showToolTip){e.title=ev.ToolTip;};e.onclick=function(e){DayPilotMonth.movingEvent=null;$d.eventClickDispatch(new DayPilotMonth.Event($d,$o,$i));e=e||window.event;e.cancelBubble=true;};e.oncontextmenu=function(){$d.eventRightClickDispatch(new DayPilotMonth.Event($d,$o,$i));return false;};e.onmousedown=function(ev){ev=ev||window.event;var $G=ev.which||ev.button;if($G===1){if(typeof(DayPilotBubble)!=='undefined'&&$d.bubble){DayPilotBubble.hideActive();};DayPilotMonth.movingEvent=null;if(this.style.cursor==='w-resize'||this.style.cursor==='e-resize'){var $H={};$H.start={};$H.start.x=$j;$H.start.y=$i;$H.event=new DayPilotMonth.Event($d,$o,$i);$H.width=DayPilot.Date.daysSpan($H.event.start().d,$H.event.end().d)+1;$H.direction=this.style.cursor;DayPilotMonth.resizingEvent=$H;}else if($d.eventMoveHandling!=='Disabled'){$d.clearShadow();var $I=DayPilot.mo2($d.relative,ev);if(!$I){return;};var $m=$d.getCellBelowPoint($I.x,$I.y);var $y=DayPilot.Date.daysDiff($o.event.Start,$d.rows[$i].start);var $w=($m.y*7+$m.x)-($i*7+$j);if($y){$w+=$y;};var $J={};$J.start={};$J.start.x=$j;$J.start.y=$i;$J.start.line=$l;$J.offset=$w;$J.colWidth=$k;$J.event=new DayPilotMonth.Event($d,$o,$i);DayPilotMonth.movingEvent=$J;}}};e.onmousemove=function(ev){if(typeof(DayPilotMonth)==='undefined'){return;};if(DayPilotMonth.movingEvent||DayPilotMonth.resizingEvent){return;};var $w=DayPilot.mo(e,ev);if(!$w)return;var $K=6;if(!$d.cellMode&&$w.x<=$K&&$d.eventResizeHandling!=='Disabled'){if($o.startsHere){e.style.cursor="w-resize";e.dpBorder='left';}else{e.style.cursor='not-allowed';}}else if(!$d.cellMode&&e.clientWidth-$w.x<=$K&&$d.eventResizeHandling!=='Disabled'){if($o.endsHere){e.style.cursor="e-resize";e.dpBorder='right';}else{e.style.cursor='not-allowed';}}else{e.style.cursor='default';};if(typeof(DayPilotBubble)!=='undefined'&&$d.bubble){if(!DayPilotMonth.movingEvent&&!DayPilotMonth.resizingEvent){$d.bubble.showEvent($d.uniqueID,new DayPilotMonth.Event($d,$o,$i));}else{DayPilotBubble.hideActive();}}};e.onmouseout=function(){if(typeof(DayPilotBubble)!=='undefined'&&$d.bubble){$d.bubble.hideOnMouseOut();};e.style.cursor='';};var back=(ev.BackColor)?ev.BackColor:this.eventBackColor;var $L=document.createElement("div");$L.unselectable='on';$L.style.marginLeft='2px';$L.style.marginRight='1px';$L.style.paddingLeft='2px';$L.style.height=(this.eventHeight-2)+'px';$L.style.border='1px solid '+$d.eventBorderColor;$L.style.overflow='hidden';$L.style.position='relative';$L.style.backgroundColor=back;$L.className=this.applyCssClass("event");if(this.rounded()){$L.style.MozBorderRadius="5px";$L.style.webkitBorderRadius="5px";$L.style.borderRadius="5px";};var $D=[];var $M=this.eventTextLayer==='Top';var $N=this.eventStartTime;var $O=this.eventEndTime;var $P=this.eventTextAlignment;var $Q=this.eventTextLeftIndent;if($N){if($P==='Left'){$D.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:");$D.push(this.eventTimeFontSize);$D.push(";color:");$D.push(this.eventTimeFontColor);$D.push(";font-family:");$D.push(this.eventTimeFontFamily);$D.push(";text-align:right;");$D.push("width:");$D.push($Q-4);$D.push("px;");$D.push("><span style='background-color:");}else{$D.push("<div unselectable='on' style='position:absolute;text-align:left;height:1px;font-size:1px;width:100%'><div unselectable='on' style='font-size:");$D.push(this.eventTimeFontSize);$D.push(";color:");$D.push(this.eventTimeFontColor);$D.push(";font-family:");$D.push(this.eventTimeFontFamily);$D.push(";'><span style='background-color:");};$D.push(back);$D.push("' unselectable='on'>");if($o.startsHere){$D.push(DayPilot.Date.hours(ev.Start,$d.timeFormat==='Clock12Hours'));}else{$D.push("~");};$D.push("</span></div></div>");};if($O){$D.push("<div unselectable='on' style='position:absolute;text-align:right;height:1px;font-size:1px;width:100%'><div unselectable='on' style='margin-right:4px;font-size:");$D.push(this.eventTimeFontSize);$D.push(";color:");$D.push(this.eventTimeFontColor);$D.push(";font-family:");$D.push(this.eventTimeFontFamily);$D.push(";'><span style='background-color:");$D.push(back);$D.push("' unselectable='on'>");if($o.endsHere){$D.push(DayPilot.Date.hours(ev.End,$d.timeFormat==='Clock12Hours'));}else{$D.push("~");};$D.push("</span></div></div>");};if($P==='Left'){var $F=$N?$Q:0;$D.push("<div style='margin-top:0px;height:");$D.push(this.eventHeight-2);$D.push("px;");$D.push(";overflow:hidden;text-align:left;padding-left:");$D.push($F);$D.push("px;font-size:");$D.push(this.eventFontSize);$D.push(";color:");$D.push(this.eventFontColor);$D.push(";font-family:");$D.push(this.eventFontFamily);$D.push("' unselectable='on'>");if(ev.InnerHTML){$D.push(ev.InnerHTML);}else{$D.push(ev.Text);};$D.push("</div>");}else if($P==='Center'){if($M){$D.push("<div style='position:absolute; text-align:center; width: 98%; height:1px; font-size: 1px;'>");$D.push("<span style='background-color:");$D.push(back);$D.push(";font-size:");$D.push(this.eventFontSize);$D.push(";color:");$D.push(this.eventFontColor);$D.push(";font-family:");$D.push(this.eventFontFamily);$D.push("' unselectable='on'>");if(ev.InnerHTML){$D.push(ev.InnerHTML);}else{$D.push(ev.Text);};$D.push("</span>");$D.push("</div>");}else{$D.push("<div style='margin-top:0px;height:");$D.push(this.eventHeight-2);$D.push("px;");$D.push(";overflow:hidden;text-align:center;font-size:");$D.push(this.eventFontSize);$D.push(";color:");$D.push(this.eventFontColor);$D.push(";font-family:");$D.push(this.eventFontFamily);$D.push("' unselectable='on'>");if(ev.InnerHTML){$D.push(ev.InnerHTML);}else{$D.push(ev.Text);};$D.push("</div>");}};$L.innerHTML=$D.join('');e.appendChild($L);this.eventDivs.push(e);if($E){this.cells[$j][$i].body.appendChild(e);}else{this.relative.appendChild(e);};if($d.afterEventRender){$d.afterEventRender(new DayPilotMonth.Event($d,$o,$i),e);}};this.isWeekend=function($R){var $S=0;var $T=6;if($R.dayOfWeek()===$S){return true;};if($R.dayOfWeek()===$T){return true;};return false;};this.lastVisibleDayOfMonth=function(){var $U=this.startDate.lastDayOfMonth();if(this.showWeekend){return $U;}while(this.isWeekend($U)){$U=$U.addDays(-1);};return $U;};this.prepareRows=function(){if(typeof this.startDate==='string'){this.startDate=DayPilot.Date.fromStringSortable(this.startDate);};if(this.viewType==='Month'){this.startDate=this.startDate.firstDayOfMonth();};this.firstDate=this.startDate.firstDayOfWeek(this.getWeekStart());if(!this.showWeekend){var $V=this.startDate.addMonths(-1).getMonth();var $W=new DayPilot.Date(this.firstDate).addDays(6);while(this.isWeekend($W)){$W=$W.addDays(-1);};if($W.getMonth()===$V){this.firstDate=DayPilot.Date.addDays(this.firstDate,7);}};var $X=this.startDate;var $Y;if(this.viewType==='Month'){var $Z=this.lastVisibleDayOfMonth().d;var $00=DayPilot.Date.daysDiff(this.firstDate,$Z)+1;$Y=Math.ceil($00/7);}else{$Y=this.weeks;};this.days=$Y*7;this.rows=[];for(var x=0;x<$Y;x++){var r={};r.start=DayPilot.Date.addDays(this.firstDate,x*7);r.end=DayPilot.Date.addDays(r.start,this.getColCount());r.events=[];r.lines=[];r.index=x;r.minHeight=this.cellHeight;r.calendar=this;r.belongsHere=function(ev){if(ev.End.getTime()===ev.Start.getTime()&&ev.Start.getTime()===this.start.getTime()){return true;};return !(ev.End.getTime()<=this.start.getTime()||ev.Start.getTime()>=this.end.getTime());};r.getPartStart=function(ev){return DayPilot.Date.max(this.start,ev.Start);};r.getPartEnd=function(ev){return DayPilot.Date.min(this.end,ev.End);};r.getStartColumn=function(ev){var $01=this.getPartStart(ev);return DayPilot.Date.daysDiff(this.start,$01);};r.getWidth=function(ev){return DayPilot.Date.daysSpan(this.getPartStart(ev),this.getPartEnd(ev))+1;};r.putIntoLine=function(ev,$j,$k,$i){var $02=this;for(var i=0;i<this.lines.length;i++){var $l=this.lines[i];if($l.isFree($j,$k)){$l.addEvent(ev,$j,$k,$i,i);return i;}};var $l=[];$l.isFree=function($j,$k){var $03=true;for(var i=0;i<this.length;i++){if(!($j+$k-1<this[i].colStart||$j>this[i].colStart+this[i].colWidth-1)){$03=false;}};return $03;};$l.addEvent=function(ev,$j,$k,$i,$04){var $o={};$o.event=ev;$o.colStart=$j;$o.colWidth=$k;$o.row=$i;$o.line=$04;$o.startsHere=$02.start.getTime()<=ev.Start.getTime();$o.endsHere=$02.end.getTime()>=ev.End.getTime();this.push($o);};$l.addEvent(ev,$j,$k,$i,this.lines.length);this.lines.push($l);return this.lines.length-1;};r.getStart=function(){var $05=0;for(var i=0;i<$d.rows.length&&i<this.index;i++){$05+=$d.rows[i].getHeight();}};r.getHeight=function(){return Math.max(this.lines.length*$d.lineHeight()+$d.cellHeaderHeight,this.calendar.cellHeight);};this.rows.push(r);};this.endDate=DayPilot.Date.addDays(this.firstDate,$Y*7);};this.getHeight=function(){var $06=this.headerHeight;for(var i=0;i<this.rows.length;i++){$06+=this.rows[i].getHeight();};return $06;};this.getWidth=function($05,end){var $07=(end.y*7+end.x)-($05.y*7+$05.x);return $07+1;};this.getMinCoords=function($08,$09){if(($08.y*7+$08.x)<($09.y*7+$09.x)){return $08;}else{return $09;}};this.drawRelative=function(){this.relative=document.createElement("div");this.nav.top=this.relative;this.relative.style.MozUserSelect='none';this.relative.style.KhtmlUserSelect='none';this.relative.style.position='relative';this.relative.style.width=this.width;this.relative.style.height=this.getHeight()+'px';this.relative.onmousemove=function(ev){if(DayPilotMonth.resizingEvent){var $I=DayPilot.mo2($d.relative,ev);if(!$I){return;};var $m=$d.getCellBelowPoint($I.x,$I.y);$d.clearShadow();var $H=DayPilotMonth.resizingEvent;var $0a=$H.start;var $v,$05;if($H.direction==='w-resize'){$05=$m;var $0b=$H.event.end().d;if(DayPilot.Date.getDate($0b).getTime()===$0b.getTime()){$0b=DayPilot.Date.addDays($0b,-1);};var end=$d.getCellFromDate($0b);$v=$d.getWidth($m,end);}else{$05=$d.getCellFromDate($H.event.start().d);$v=$d.getWidth($05,$m);};if($v<1){$v=1;};$d.drawShadow($05.x,$05.y,0,$v);}else if(DayPilotMonth.movingEvent){var $I=DayPilot.mo2($d.relative,ev);if(!$I){return;};var $m=$d.getCellBelowPoint($I.x,$I.y);$d.clearShadow();var event=DayPilotMonth.movingEvent.event;var $w=DayPilotMonth.movingEvent.offset;var $v=$d.cellMode?1:DayPilot.Date.daysSpan(event.start().d,event.end().d)+1;if($v<1){$v=1;};$d.drawShadow($m.x,$m.y,0,$v,$w,event);}else if(DayPilotMonth.timeRangeSelecting){var $I=DayPilot.mo2($d.relative,ev);if(!$I){return;};var $m=$d.getCellBelowPoint($I.x,$I.y);$d.clearShadow();var $05=DayPilotMonth.timeRangeSelecting;var $0c=$05.y*7+$05.x;var $0d=$m.y*7+$m.x;var $v=Math.abs($0d-$0c)+1;if($v<1){$v=1;};var $0e=$0c<$0d?$05:$m;DayPilotMonth.timeRangeSelecting.from={x:$0e.x,y:$0e.y};DayPilotMonth.timeRangeSelecting.width=$v;DayPilotMonth.timeRangeSelecting.moved=true;$d.drawShadow($0e.x,$0e.y,0,$v,0,null);}};$c.appendChild(this.relative);this.vsph=document.createElement("div");this.vsph.style.display='none';$c.appendChild(this.vsph);};this.message=function($0f,$0g,$0h,$0i){if($0f===null){return;};var $0g=$0g||2000;var $0h=$0h||"#ffffff";var $0i=$0i||"#000000";var top=this.headerHeight;var $F=1;var $0j=-1;var $n;if(this.nav.message){$n=this.nav.message;$n.firstChild.style.color=$0h;$n.firstChild.style.backgroundColor=$0i;$n.firstChild.innerHTML=$0f;}else{$n=document.createElement("div");$n.style.position="absolute";$n.style.width="100%";$n.style.left="0px";$n.style.textAlign="left";$n.style.top=top+"px";$n.style.opacity=0.8;$n.style.filter="alpha(opacity=80)";$n.style.display='none';var $L=document.createElement("div");$L.style.marginLeft=$F+"px";$L.style.marginRight=$0j+"px";$L.style.backgroundColor=$0i;$L.style.color=$0h;$L.style.padding="5px";$L.innerHTML=$0f;$n.appendChild($L);this.nav.top.appendChild($n);this.nav.message=$n;};if(this.nav.message.style.display!=='none'){clearTimeout($d.messageTimeout);};var end=function(){$d.messageTimeout=setTimeout($d.hideMessage,$0g);};DayPilot.fade($n,0.1,end);};this.message=function($0f,$0g,$0h,$0i){if($0f===null){return;};var $0g=$0g||2000;var $0h=$0h||"#ffffff";var $0i=$0i||"#000000";var $0k=0.8;var top=this.headerHeight;var $F=1;var $0j=-1;var $n;if(!this.nav.message){$n=document.createElement("div");$n.style.position="absolute";$n.style.width="100%";$n.style.left="0px";$n.style.textAlign="left";$n.style.top=top+"px";$n.style.opacity=$0k;$n.style.filter="alpha(opacity="+($0k*100)+")";$n.style.display='none';var $L=document.createElement("div");$L.style.marginLeft=$F+"px";$L.style.marginRight=$0j+"px";$L.style.padding="5px";$n.appendChild($L);var close=document.createElement("div");close.style.top="5px";close.style.right=(DayPilot.sw($d.nav.scroll)+5)+"px";close.style.color=$0h;close.style.lineHeight="100%";close.style.position="absolute";close.style.cursor="pointer";close.style.fontWeight="bold";close.innerHTML="X";close.onclick=function(){$d.nav.message.style.display='none';};$n.appendChild(close);this.nav.top.appendChild($n);this.nav.message=$n;};var $0l=function(){$d.nav.message.style.opacity=$0k;var $L=$d.nav.message.firstChild;$L.style.backgroundColor=$0i;$L.style.color=$0h;$L.innerHTML=$0f;var end=function(){$d.messageTimeout=setTimeout($d.hideMessage,$0g);};DayPilot.fade($d.nav.message,0.2,end);};if(this.nav.message.style.display!=='none'){clearTimeout($d.messageTimeout);DayPilot.fade($d.nav.message,-0.2,$0l);}else{$0l();}};this.hideMessage=function(){var end=function(){$d.nav.message.style.display='none';};DayPilot.fade($d.nav.message,-0.2,end);};this.updateHeight=function(){this.relative.style.height=this.getHeight()+'px';for(var x=0;x<this.cells.length;x++){for(var y=0;y<this.cells[x].length;y++){this.cells[x][y].style.top=this.getRowTop(y)+'px';this.cells[x][y].style.height=this.rows[y].getHeight()+'px';}}};this.getCellBelowPoint=function(x,y){var $0m=Math.floor(this.relative.clientWidth/this.getColCount());var $0n=Math.min(Math.floor(x/$0m),this.getColCount()-1);var $i=null;var $06=this.headerHeight;for(var i=0;i<this.rows.length;i++){$06+=this.rows[i].getHeight();if(y<$06){$i=i;break;}};if($i===null){$i=this.rows.length-1;};var $m={};$m.x=$0n;$m.y=$i;return $m;};this.getCellFromDate=function($R){var $v=DayPilot.Date.daysDiff(this.firstDate,$R);var $m={x:0,y:0};while($v>=7){$m.y++;$v-=7;};$m.x=$v;return $m;};this.drawTable=function(){var $0o=document.createElement("div");$0o.oncontextmenu=function(){return false;};this.relative.appendChild($0o);this.cells=[];for(var x=0;x<this.getColCount();x++){this.cells[x]=[];var $0p=this.headerProperties?this.headerProperties[x]:null;var $0q=document.createElement("div");$0q.unselectable='on';$0q.style.position='absolute';$0q.style.left=(this.getCellWidth()*x)+'%';$0q.style.width=(this.getCellWidth())+'%';$0q.style.top='0px';$0q.style.height=(this.headerHeight)+'px';$0q.style.backgroundColor=$0p?$0p.BackColor:this.headerBackColor;$0q.style.fontFamily=this.headerFontFamily;$0q.style.fontSize=this.headerFontSize;$0q.style.color=this.headerFontColor;$0q.style.borderLeft='1px solid '+this.borderColor;$0q.style.borderTop='1px solid '+this.borderColor;$0q.style.borderBottom='1px solid '+this.borderColor;$0q.style.textAlign='center';$0q.style.cursor='default';$0q.className=this.applyCssClass("header");if(x===this.getColCount()-1){$0q.style.borderRight='1px solid '+this.borderColor;};var $0r=x+this.getWeekStart();if($0r>6){$0r-=7;};$0q.innerHTML=$0p?$0p.InnerHTML:this.dayNames[$0r];(function(x){$0q.onclick=function(){$d.headerClickDispatch(x);};})($0r);$0o.appendChild($0q);for(var y=0;y<this.rows.length;y++){this.drawCell(x,y,$0o);}};var $n=document.createElement("div");$n.style.position='absolute';$n.style.padding='2px';$n.style.top='0px';$n.style.left='0px';$n.style.backgroundColor="#FF6600";$n.style.color="white";$n.innerHTML="\u0044\u0045\u004D\u004F";if(this.numberFormat)this.relative.appendChild($n);};this.clearTable=function(){for(var x=0;x<this.cells.length;x++){for(var y=0;y<this.cells[x].length;y++){this.cells[x][y].onclick=null;}};this.relative.innerHTML='';};this.drawCell=function(x,y,$0o){var $i=this.rows[y];var d=DayPilot.Date.addDays(this.firstDate,y*7+x);var $0s=this.cellProperties?this.cellProperties[y*this.getColCount()+x]:null;var $m=document.createElement("div");$m.unselectable='on';$m.style.position='absolute';$m.style.cursor='default';$m.style.left=(this.getCellWidth()*x)+'%';$m.style.width=(this.getCellWidth())+'%';$m.style.top=(this.getRowTop(y))+'px';$m.style.height=($i.getHeight())+'px';var $V=this.startDate.addMonths(-1).getMonth();var $0t=this.startDate.addMonths(1).getMonth();var $0u=this.startDate.getMonth();if(d.getUTCMonth()===$0u){$m.className=this.applyCssClass("cell");}else if(d.getUTCMonth()===$V){$m.className=this.applyCssClass("cell")+" "+this.applyCssClass("previous");}else if(d.getUTCMonth()===$0t){$m.className=this.applyCssClass("cell")+" "+this.applyCssClass("next");}else{$a();};if($0s){$m.style.backgroundColor=$0s["BackColor"];$m.className+=" "+this.applyCssClass($0s["CssClass"]);}else{$m.style.backgroundColor=this.getCellBackColor(d);};if(x===0){$m.style.borderLeft='1px solid '+this.borderColor;}else{$m.style.borderLeft='1px solid '+this.innerBorderColor;};if(y===0){$m.style.borderTop='1px solid '+this.borderColor;}else{$m.style.borderTop='1px solid '+this.innerBorderColor;};$m.style.borderBottom='1px solid '+this.borderColor;if(x===this.getColCount()-1){$m.style.borderRight='1px solid '+this.borderColor;};$m.onmousedown=function(){if($d.timeRangeSelectedHandling!=='Disabled'){$d.clearShadow();DayPilotMonth.timeRangeSelecting={"root":$d,"x":x,"y":y,"from":{x:x,y:y},"width":1};}};$m.oncontextmenu=function(){var go=function(d){var $05=new DayPilot.Date(d);var end=$05.addDays(1);var $0v=new DayPilot.Selection($05,end,null,$d);if($d.contextMenuSelection){$d.contextMenuSelection.show($0v);}};go(d);};$m.onclick=function(){var $0w=function(d){var $05=new DayPilot.Date(d);var end=$05.addDays(1);$d.timeRangeSelectedDispatch($05,end);};if($d.timeRangeSelectedHandling!=='Disabled'&&$d.timeRangeDoubleClick==='Disabled'){$0w(d);return;};if(!$d.timeouts){$d.timeouts=[];};var $0x=function(d){return function(){$0w(d);};};$d.timeouts.push(window.setTimeout($0x(d),300));};$m.ondblclick=function(){if($d.timeouts){for(var $0y in $d.timeouts){window.clearTimeout($d.timeouts[$0y]);};$d.timeouts=null;};if($d.timeRangeDoubleClickHandling!=='Disabled'){var $05=new DayPilot.Date(d);var end=$05.addDays(1);$d.timeRangeDoubleClickDispatch($05,end);}};var $0z=document.createElement("div");if($0s&&$0s["HeaderBackColor"]){$0z.style.backgroundColor=$0s["HeaderBackColor"];}else if(this.cellHeaderBackColor){$0z.style.backgroundColor=this.cellHeaderBackColor;};$0z.style.paddingRight='2px';$0z.style.textAlign="right";$0z.style.fontFamily=this.cellHeaderFontFamily;$0z.style.fontSize=this.cellHeaderFontSize;$0z.style.color=this.cellHeaderFontColor;$0z.style.height=this.cellHeaderHeight+"px";$0z.unselectable="on";$0z.className=this.applyCssClass("cellheader");if($0s){$0z.innerHTML=$0s["HeaderText"];}else{var $R=d.getUTCDate();if($R===1){$0z.innerHTML=this.monthNames[d.getUTCMonth()]+' '+$R;}else{$0z.innerHTML=$R;}};$m.appendChild($0z);if(this.cellMode){var $0A=document.createElement("div");$0A.style.height=(this.cellHeight-this.cellHeaderHeight)+"px";$0A.style.overflow='auto';$0A.style.position='relative';var $L=document.createElement('div');$L.style.paddingTop="1px";$L.style.paddingBottom="1px";$0A.appendChild($L);$m.appendChild($0A);$m.body=$L;};this.cells[x][y]=$m;$0o.appendChild($m);};this.getWeekStart=function(){if(this.showWeekend){return this.weekStarts;}else{return 1;}};this.getColCount=function(){if(this.showWeekend){return 7;}else{return 5;}};this.getCellWidth=function(){if(this.showWeekend){return 14.285;}else{return 20;}};this.getCellBackColor=function(d){if(d.getUTCDay()===6||d.getUTCDay()===0){return this.nonBusinessBackColor;};return this.backColor;};this.getRowTop=function($04){var top=this.headerHeight;for(var i=0;i<$04;i++){top+=this.rows[i].getHeight();};return top;};this.postBack=function($0B){var $0C=[];for(var i=1;i<arguments.length;i++){$0C.push(arguments[i]);};__doPostBack($d.uniqueID,$0B+DayPilot.ea($0C));};this.postBack2=function($0D,$0E,$0F){var $0G={};$0G.action=$0D;$0G.parameters=$0F;$0G.data=$0E;$0G.header=this.getCallBackHeader();var $0H="JSON"+DayPilot.JSON.stringify($0G);__doPostBack($d.uniqueID,$0H);};this.callBack2=function($0D,$0E,$0F){var $0G={};$0G.action=$0D;$0G.parameters=$0F;$0G.data=$0E;$0G.header=this.getCallBackHeader();var $0H="JSON"+DayPilot.JSON.stringify($0G);if(this.backendUrl){DayPilot.request(this.backendUrl,this.callBackResponse,$0H,this.ajaxError);}else{WebForm_DoCallback(this.uniqueID,$0H,this.updateView,null,this.callbackError,true);}};this.callBackResponse=function($0I){$d.updateView($0I.responseText);};this.getCallBackHeader=function(){var h={};h.control="dpm";h.id=this.id;h.visibleStart=new DayPilot.Date(this.firstDate);h.visibleEnd=h.visibleStart.addDays(this.days);h.clientState=this.clientState;h.startDate=$d.startDate;h.showWeekend=this.showWeekend;h.headerBackColor=this.headerBackColor;h.backColor=this.backColor;h.nonBusinessBackColor=this.nonBusinessBackColor;h.locale=this.locale;h.timeFormat=this.timeFormat;h.weekStarts=this.weekStarts;h.viewType=this.viewType;h.weeks=this.weeks;h.hashes=$d.hashes;return h;};this.eventClickPostBack=function(e,$0E){this.postBack2("EventClick",$0E,e);};this.eventClickCallBack=function(e,$0E){this.callBack2('EventClick',$0E,e);};this.eventClickDispatch=function(e){if(!e.clickingAllowed()){return;};switch($d.eventClickHandling){case 'PostBack':$d.eventClickPostBack(e);break;case 'CallBack':$d.eventClickCallBack(e);break;case 'JavaScript':$d.onEventClick(e);break;case 'ContextMenu':if(e.contextMenu){eval(e.contextMenu+".show(this.event)");}else{if($d.contextMenu){$d.contextMenu.show(e);}};break;}};this.eventRightClickPostBack=function(e,$0E){this.postBack2("EventRightClick",$0E,e);};this.eventRightClickCallBack=function(e,$0E){this.callBack2('EventRightClick',$0E,e);};this.eventRightClickDispatch=function(e){this.event=e;if(!e.rightClickingAllowed()){return false;};switch($d.eventRightClickHandling){case 'PostBack':$d.eventRightClickPostBack(e);break;case 'CallBack':$d.eventRightClickCallBack(e);break;case 'JavaScript':$d.onEventRightClick(e);break;case 'ContextMenu':if(e.contextMenu){eval(e.contextMenu+".show(this.event)");}else{if($d.contextMenu){$d.contextMenu.show(e);}};break;};return false;};this.eventMenuClickPostBack=function(e,$0J,$0E){var $0K={};$0K.e=e;$0K.command=$0J;this.postBack2('EventMenuClick',$0E,$0K);};this.eventMenuClickCallBack=function(e,$0J,$0E){var $0K={};$0K.e=e;$0K.command=$0J;this.callBack2('EventMenuClick',$0E,$0K);};this.eventMenuClick=function($0J,e,$0L){switch($0L){case 'PostBack':$d.eventMenuClickPostBack(e,$0J);break;case 'CallBack':$d.eventMenuClickCallBack(e,$0J);break;}};this.eventMovePostBack=function(e,$0M,$0N,$0E){if(!$0M)throw 'newStart is null';if(!$0N)throw 'newEnd is null';var $0K={};$0K.e=e;$0K.newStart=$0M;$0K.newEnd=$0N;this.postBack2('EventMove',$0E,$0K);};this.eventMoveCallBack=function(e,$0M,$0N,$0E){if(!$0M)throw 'newStart is null';if(!$0N)throw 'newEnd is null';var $0K={};$0K.e=e;$0K.newStart=$0M;$0K.newEnd=$0N;this.callBack2('EventMove',$0E,$0K);};this.eventMoveDispatch=function(e,x,y,$w,ev){var $0O=DayPilot.Date.getTime(e.start().d);var $0b=DayPilot.Date.getDate(e.end().d);if($0b.getTime()!==e.end().d.getTime()){$0b=DayPilot.Date.addDays($0b,1);};var $0P=DayPilot.Date.diff(e.end().d,$0b);var $0Q=this.getDateFromCell(x,y);$0Q=DayPilot.Date.addDays($0Q,-$w);var $v=DayPilot.Date.daysSpan(e.start().d,e.end().d)+1;var $0R=DayPilot.Date.addDays($0Q,$v);var $0M=new DayPilot.Date(DayPilot.Date.addTime($0Q,$0O));var $0N=new DayPilot.Date(DayPilot.Date.addTime($0R,$0P));switch($d.eventMoveHandling){case 'PostBack':$d.eventMovePostBack(e,$0M,$0N);break;case 'CallBack':$d.eventMoveCallBack(e,$0M,$0N);break;case 'JavaScript':$d.onEventMove(e,$0M,$0N,ev.ctrlKey,ev.shiftKey);break;}};this.eventResizePostBack=function(e,$0M,$0N,$0E){if(!$0M)throw 'newStart is null';if(!$0N)throw 'newEnd is null';var $0K={};$0K.e=e;$0K.newStart=$0M;$0K.newEnd=$0N;this.postBack2('EventResize',$0E,$0K);};this.eventResizeCallBack=function(e,$0M,$0N,$0E){if(!$0M)throw 'newStart is null';if(!$0N)throw 'newEnd is null';var $0K={};$0K.e=e;$0K.newStart=$0M;$0K.newEnd=$0N;this.callBack2('EventResize',$0E,$0K);};this.eventResizeDispatch=function(e,$05,$v){var $0O=DayPilot.Date.getTime(e.start().d);var $0b=DayPilot.Date.getDate(e.end().d);if(!DayPilot.Date.equals($0b,e.end().d)){$0b=DayPilot.Date.addDays($0b,1);};var $0P=DayPilot.Date.diff(e.end().d,$0b);var $0Q=this.getDateFromCell($05.x,$05.y);var $0R=DayPilot.Date.addDays($0Q,$v);var $0M=new DayPilot.Date(DayPilot.Date.addTime($0Q,$0O));var $0N=new DayPilot.Date(DayPilot.Date.addTime($0R,$0P));switch($d.eventResizeHandling){case 'PostBack':$d.eventResizePostBack(e,$0M,$0N);break;case 'CallBack':$d.eventResizeCallBack(e,$0M,$0N);break;case 'JavaScript':$d.onEventResize(e,$0M,$0N);break;}};this.timeRangeSelectedPostBack=function($05,end,$0E){var $0S={};$0S.start=$05;$0S.end=end;this.postBack2('TimeRangeSelected',$0E,$0S);};this.timeRangeSelectedCallBack=function($05,end,$0E){var $0S={};$0S.start=$05;$0S.end=end;this.callBack2('TimeRangeSelected',$0E,$0S);};this.timeRangeSelectedDispatch=function($05,end){switch($d.timeRangeSelectedHandling){case 'PostBack':$d.timeRangeSelectedPostBack($05,end);break;case 'CallBack':$d.timeRangeSelectedCallBack($05,end);break;case 'JavaScript':$d.onTimeRangeSelected($05,end);break;}};this.timeRangeMenuClickPostBack=function(e,$0J,$0E){var $0K={};$0K.selection=e;$0K.command=$0J;this.postBack2("TimeRangeMenuClick",$0E,$0K);};this.timeRangeMenuClickCallBack=function(e,$0J,$0E){var $0K={};$0K.selection=e;$0K.command=$0J;this.callBack2("TimeRangeMenuClick",$0E,$0K);};this.timeRangeMenuClick=function($0J,e,$0L){switch($0L){case 'PostBack':$d.timeRangeMenuClickPostBack(e,$0J);break;case 'CallBack':$d.timeRangeMenuClickCallBack(e,$0J);break;}};this.headerClickPostBack=function(c,$0E){this.postBack2('HeaderClick',$0E,c);};this.headerClickCallBack=function(c,$0E){this.callBack2('HeaderClick',$0E,c);};this.headerClickDispatch=function(x){var $0E=this.data;var c={$0z:x};switch($d.headerClickHandling){case 'PostBack':$d.headerClickPostBack(c);break;case 'CallBack':$d.headerClickCallBack(c);break;case 'JavaScript':$d.onHeaderClick(c);break;}};this.timeRangeDoubleClickPostBack=function($05,end,$0E){var $0S={};$0S.start=$05;$0S.end=end;this.postBack2('TimeRangeDoubleClick',$0E,$0S);};this.timeRangeDoubleClickCallBack=function($05,end,$0E){var $0S={};$0S.start=$05;$0S.end=end;this.callBack2('TimeRangeDoubleClick',$0E,$0S);};this.timeRangeDoubleClickDispatch=function($05,end){switch($d.timeRangeDoubleClickHandling){case 'PostBack':$d.timeRangeDoubleClickPostBack($05,end);break;case 'CallBack':$d.timeRangeDoubleClickCallBack($05,end);break;case 'JavaScript':$d.onTimeRangeDoubleClick($05,end);break;}};this.commandCallBack=function($0J,$0E){this.stopAutoRefresh();var $0K={};$0K.command=$0J;this.callBack2('Command',$0E,$0K);};this.startAutoRefresh=function($0T){if($0T){this.autoRefreshEnabled=true;};if(!this.autoRefreshEnabled){return;};if(this.autoRefreshCount>=this.autoRefreshMaxCount){return;};this.stopAutoRefresh();var $0U=this.autoRefreshInterval;if(!$0U||$0U<10){throw "The minimum autoRefreshInterval is 10 seconds";};this.autoRefreshTimeout=window.setTimeout(function(){$d.doRefresh();},this.autoRefreshInterval*1000);};this.stopAutoRefresh=function(){if(this.autoRefreshTimeout){window.clearTimeout(this.autoRefreshTimeout);}};this.doRefresh=function(){if(!DayPilotMonth.eventResizing&&!DayPilotMonth.eventMoving&&!DayPilotMonth.timeRangeSelecting){this.autoRefreshCount++;this.commandCallBack(this.autoRefreshCommand);};if(this.autoRefreshCount<this.autoRefreshMaxCount){this.autoRefreshTimeout=window.setTimeout(function(){$d.doRefresh();},this.autoRefreshInterval*1000);}};this.registerGlobalHandlers=function(){if(!DayPilotMonth.globalHandlers){DayPilotMonth.globalHandlers=true;DayPilot.re(document,'mouseup',DayPilotMonth.gMouseUp);}};this.loadFromServer=function(){return(typeof this.events==='undefined')||(this.events===null);};this.initShort=function(){this.prepareRows();this.drawRelative();this.drawTable();this.registerGlobalHandlers();this.startAutoRefresh();this.callBack2('Init');};this.Init=function(){var $0V=this.loadFromServer();if($0V){this.initShort();return;};this.prepareRows();this.prepareEvents();this.drawRelative();this.drawTable();this.drawEvents();this.registerGlobalHandlers();if(this.messageHTML){this.message(this.messageHTML,5000);};this.afterRender(null,false);this.startAutoRefresh();};};DayPilotMonth.Event=function($d,$o,$i){this.root=$d;this.contextMenu=$o.event.ContextMenu;this.eventPart=$o;this.value=function(){return $o.event.Value;};this.text=function(){return $o.event.Text;};this.start=function(){return new DayPilot.Date($o.event.Start);};this.end=function(){return new DayPilot.Date($o.event.End);};this.recurrent=function(){return $o.event.Recurrent;};this.recurrentMasterId=function(){return $o.event.RecurrentMasterId;};this.staticBubbleHTML=function(){return $o.event.StaticBubbleHTML;};this.partStart=function(){return $d.rows[$i].getPartStart($o.event);};this.partEnd=function(){return $d.rows[$i].getPartEnd($o.event);};this.tag=function($0W){var t=$o.event.Tag;if(!$0W){return t;};var $0X=$d.tagFields.split(",");var $04=-1;for(var i=0;i<$0X.length;i++){if($0W===$0X[i])$04=i;};if($04===-1){throw "Field name not found.";};return t[$04];};this.clickingAllowed=function(){return true;};this.rightClickingAllowed=function(){return true;};this.toJSON=function($0Y){var $0Z={};$0Z.value=this.value();$0Z.text=this.text();$0Z.start=this.start();$0Z.end=this.end();$0Z.resource=null;$0Z.isAllDay=false;$0Z.recurrentMasterId=this.recurrentMasterId();$0Z.tag={};if($d.tagFields){var $0X=$d.tagFields.split(",");for(var i=0;i<$0X.length;i++){$0Z.tag[$0X[i]]=this.tag($0X[i]);}};return $0Z;};};DayPilotMonth.gMouseUp=function(ev){if(DayPilotMonth.movingEvent&&DayPilotMonth.movingEvent.event.root.shadow){var $d=DayPilotMonth.movingEvent.event.root;var e=DayPilotMonth.movingEvent.event;var $05=$d.shadow.start;var $w=DayPilotMonth.movingEvent.offset;$d.clearShadow();DayPilotMonth.movingEvent=null;var ev=ev||window.event;$d.eventMoveDispatch(e,$05.x,$05.y,$w,ev);ev.cancelBubble=true;if(ev.stopPropagation){ev.stopPropagation();};DayPilotMonth.movingEvent=null;return false;}else if(DayPilotMonth.resizingEvent){var $d=DayPilotMonth.resizingEvent.event.root;var e=DayPilotMonth.resizingEvent.event;var $05=$d.shadow.start;var $v=$d.shadow.width;$d.clearShadow();DayPilotMonth.resizingEvent=null;$d.eventResizeDispatch(e,$05,$v);ev.cancelBubble=true;DayPilotMonth.resizingEvent=null;return false;}else if(DayPilotMonth.timeRangeSelecting){if(DayPilotMonth.timeRangeSelecting.moved){var $10=DayPilotMonth.timeRangeSelecting;var $d=$10.root;var $05=new DayPilot.Date($d.getDateFromCell($10.from.x,$10.from.y));var end=$05.addDays($10.width);$d.timeRangeSelectedDispatch($05,end);$d.clearShadow();};DayPilotMonth.timeRangeSelecting=null;}};DayPilot.MonthVisible.Month=DayPilotMonth.Month;DayPilot.Month=DayPilotMonth.Month;})();

